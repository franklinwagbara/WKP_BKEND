USE [workprogram]
GO
/****** Object:  View [dbo].[WP_OPL_Exploratory_Drilling_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_Exploratory_Drilling_INDEX_MN_MAX_RGT_by_YEAR]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                              CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN CATEGORY = '2nd Appraisal'
                                                                                               THEN 100 ELSE '0' END AS Unscaled_Score
                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                           CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN CATEGORY = '2nd Appraisal'
                                                                                                                            THEN 100 ELSE '0' END AS Unscaled_Score
                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_1
                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE]
AS
SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Exploratory Drilling Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                              CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN CATEGORY
                                                                                                                                               = '2nd Appraisal' THEN 100 ELSE '0' END AS Unscaled_Score
                                                                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                                           CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN
                                                                                                                                                                            CATEGORY = '2nd Appraisal' THEN 100 ELSE '0' END AS Unscaled_Score
                                                                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_1
                                                                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OPL_Exploratory_Drilling_INDEX_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OPL') AND (INDEX_TYPE = 'Exploratory Drilling Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_Concession_Rentals_Index_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_Concession_Rentals_Index_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                              CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.CONCESSION_SITUATION
                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                               GROUP BY CompanyName, Year, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                                                           CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.CONCESSION_SITUATION AS CONCESSION_SITUATION_1
                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A_1
                                                                            GROUP BY CompanyName, Year, Consession_Type) AS c
                                                    GROUP BY Year) AS E ON D.Year = E.Year) AS F
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_OPL_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Concession Rentals Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                                                                                CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.CONCESSION_SITUATION
                                                                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                                                                               GROUP BY CompanyName, Year, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                                                                                                            CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.CONCESSION_SITUATION AS CONCESSION_SITUATION_1
                                                                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A
                                                                                                                            GROUP BY CompanyName, Year, Consession_Type) AS c
                                                                                                    GROUP BY Year) AS E ON D.Year = E.Year) AS F INNER JOIN
                                                                      dbo.WP_OPL_Concession_Rentals_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year = G.Year) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OPL') AND (INDEX_TYPE = 'Concession Rentals Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OPL_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR]
AS

SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum,

                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											  ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                       FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved,
																	  ISNULL(Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score

                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS NUMERIC(10,2))) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS NUMERIC(10,2))) 
                                                                                              AS Quantum_Approved
                                                                       FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, 
													ISNULL(Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score

                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                           SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                    FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                    WHERE      (Consession_Type = 'OPL')
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP


GO
/****** Object:  View [dbo].[WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE]
AS

SELECT     H.CompanyName, H.Quantum_Acquired, H.Quantum_Approved, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Quantum_Acquired, E.Quantum_Approved, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + (E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) 
                                              * (100 - 0), 0) AS Recalibrated_Scaled_Index, 'Acquisition Index' AS INDEX_TYPE, 'OPL' AS Consession_Type
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                                                     -- b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
																	   ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                                               FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, 
											   ISNULL(Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score

                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS NUMERIC(10,2) )) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS NUMERIC(10,2) )) 
                                                                                                                      AS Quantum_Approved
                                                                                               FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved,
																			ISNULL(Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score

                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                                                   SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                                            FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                                            WHERE      (Consession_Type = 'OPL')
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN

                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OPL_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OPL') AND (INDEX_TYPE = 'Acquisition Index')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                              CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                                                           CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_1
                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Discovery Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                                            CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_1
                                                                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OPL') AND (INDEX_TYPE = 'Discovery Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE


GO
/****** Object:  View [dbo].[WP_OPL_WEIGHTED_AND_RECALIBRATED_SCORE_UNION_ALL_COMPANIES]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [dbo].[WP_OPL_WEIGHTED_AND_RECALIBRATED_SCORE_UNION_ALL_COMPANIES]
AS
/****** Script for SelectTopNRows command from SSMS  ******/
SELECT  [CompanyName]
  ,[INDEX_TYPE]
      ,[Unscaled_Score]
      ,[Unscaled_Score_sum]
      ,[Scaled_by_Reciprocal_GrandTotal_RGT]
       ,[MAX_RGT]
      ,[MIN_RGT]
      ,[Year_of_WP]
     
      ,[Recalibrated_Scaled_Index]
    
      ,[Weight]
      ,[Weighted_Score]
      ,[Consession_Type]
  FROM [dbo].[WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE]
  
  UNION ALL
  
  --SELECT  [CompanyName]
  --,[INDEX_TYPE]
  --    ,[Unscaled_Score]
  --    ,[Unscaled_Score_sum]
  --    ,[Scaled_by_Reciprocal_GrandTotal_RGT]
  --     ,[MAX_RGT]
  --    ,[MIN_RGT]
  --    ,[Year_of_WP]
     
  --    ,[Recalibrated_Scaled_Index]
    
  --    ,[Weight]
  --    ,[Weighted_Score]
  --    ,[Consession_Type]
  --FROM [WP_OPL_COMPLIANCE_INDEX_WEIGHTED_SCORE]
  
  -- UNION ALL
  
  SELECT  [CompanyName]
  ,[INDEX_TYPE]
      ,[Unscaled_Score]
      ,[Unscaled_Score_sum]
      ,[Scaled_by_Reciprocal_GrandTotal_RGT]
       ,[MAX_RGT]
      ,[MIN_RGT]
      ,[Year]
     
      ,[Recalibrated_Scaled_Index]
    
      ,[Weight]
      ,[Weighted_Score]
      ,[Consession_Type]
  FROM [dbo].WP_OPL_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE
  
   UNION ALL
  
  SELECT  [CompanyName]
  ,[INDEX_TYPE]
      ,[Unscaled_Score]
      ,[Unscaled_Score_sum]
      ,[Scaled_by_Reciprocal_GrandTotal_RGT]
       ,[MAX_RGT]
      ,[MIN_RGT]
      ,[Year_of_WP]
     
      ,[Recalibrated_Scaled_Index]
    
      ,[Weight]
      ,[Weighted_Score]
      ,[Consession_Type]
  FROM [dbo].WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE
  
   UNION ALL
  
  SELECT  [CompanyName]
  ,[INDEX_TYPE]
      ,[Unscaled_Score]
      ,[Unscaled_Score_sum]
      ,[Scaled_by_Reciprocal_GrandTotal_RGT]
       ,[MAX_RGT]
      ,[MIN_RGT]
      ,[Year_of_WP]
     
      ,[Recalibrated_Scaled_Index]
    
      ,[Weight]
      ,[Weighted_Score]
      ,[Consession_Type]
  FROM [dbo].WP_OPL_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE
GO
/****** Object:  View [dbo].[WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

			   
CREATE VIEW [dbo].[WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR]
AS

SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                             -- b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
											   ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved,
					   
												-- Quantum_Acquired / CONVERT(decimal(18, 1), Quantum_Approved) * 100 AS Unscaled_Score

												 ISNULL( Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score

                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS NUMERIC(10,2) )) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS NUMERIC(10,2) )) 
                                                                                              AS Quantum_Approved
                                                                       FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                      -- where  Quantum_Approved != 0
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM       (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved,
													
													-- Quantum_Acquired / ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Quantum_Approved),0),1) * 100 AS Unscaled_Score
													 ISNULL( Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score
                                                    
                                                    
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS NUMERIC(20,2) )) AS Quantum_Acquired, 
                                                                                                                           SUM(CAST(Quantum_Approved AS NUMERIC(20,2) )) AS Quantum_Approved
                                                                                                    FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                    WHERE      (Consession_Type = 'OML') 
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP


GO
/****** Object:  View [dbo].[WP_OML_ACQUSITION_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_ACQUSITION_INDEX_WEIGHTED_SCORE_OLD]
AS
SELECT     H.CompanyName, H.Quantum_Acquired, H.Quantum_Approved, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Quantum_Acquired, E.Quantum_Approved, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + (E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) 
                                              * (100 - 0), 0) AS Recalibrated_Scaled_Index, 'Acquisition Index' AS INDEX_TYPE, 'OML' AS Consession_Type
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                                                      b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), 
                                                                                              Quantum_Approved) * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS int)) 
                                                                                                                      AS Quantum_Approved
                                                                                               FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), 
                                                                                                                           Quantum_Approved) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                                                   SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                                            FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                                            WHERE      (Consession_Type = 'OML')
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Acquisition Index')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_Aggregated_Score_ALL_COMPANIES_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [dbo].[WP_OPL_Aggregated_Score_ALL_COMPANIES_OLD]
AS
SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE , Recalibrated_Scaled_Index_SUM, Weight_SUM, Weighted_Score_SUM, 
                      Weighted_Score_SUM / CONVERT(decimal(18, 3), Weight_SUM) AS OPL_Aggregated_Score
FROM         (SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE , SUM(CAST(Recalibrated_Scaled_Index AS int)) AS Recalibrated_Scaled_Index_SUM, 
                                              SUM(CAST(Weight AS int)) AS Weight_SUM, SUM(CAST(Weighted_Score AS int)) AS Weighted_Score_SUM
                       FROM          (SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM          dbo.WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE
                                               --UNION ALL
                                               --SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               --FROM         dbo.WP_OPL_COMPLIANCE_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year AS YEAR_OF_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE) AS SUM_ALL
                       GROUP BY CompanyName, Consession_Type, Year_of_WP , INDEX_TYPE) AS OPL_Aggregated_Score
GO
/****** Object:  View [dbo].[WP_OPL_Aggregated_Score_ALL_COMPANIES]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





CREATE VIEW [dbo].[WP_OPL_Aggregated_Score_ALL_COMPANIES]
AS

SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE , Recalibrated_Scaled_Index_SUM, Weight_SUM, Weighted_Score_SUM, 
                    -- Weighted_Score_SUM / CONVERT(decimal(18, 3), Weight_SUM) AS OPL_Aggregated_Score
					   ISNULL( Weighted_Score_SUM / NULLIF(Weight_SUM, 0), 0)  * 100 AS OPL_Aggregated_Score
FROM         (SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE , SUM(CAST(Recalibrated_Scaled_Index AS NUMERIC(10,2) )) AS Recalibrated_Scaled_Index_SUM, 
                                              SUM(CAST(Weight AS int)) AS Weight_SUM, SUM(CAST(Weighted_Score AS NUMERIC(10,2) )) AS Weighted_Score_SUM
                       FROM          (SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM          dbo.WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE
                                               --UNION ALL
                                               --SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               --FROM         dbo.WP_OPL_COMPLIANCE_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year AS YEAR_OF_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE) AS SUM_ALL
                       GROUP BY CompanyName, Consession_Type, Year_of_WP , INDEX_TYPE) AS OPL_Aggregated_Score

GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE]
AS
SELECT DISTINCT 
                      a.Contract_Type, a.Annual_Total_Production_by_company, a.Year_of_WP, b.Annual_Total_Production_by_year, CONVERT(decimal(18, 2), 
                      a.Annual_Total_Production_by_company) / b.Annual_Total_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     Contract_Type, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, Year_of_WP
                       FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
                       GROUP BY Contract_Type, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Production AS int)) AS Annual_Total_Production_by_year, Year_of_WP
                            FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE_chart]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE_chart]
AS
SELECT     TOP (1000) Contract_Type, Year_of_WP, CAST(ROUND(Percentage_Production, 0) AS int) AS Percentage_Production
FROM         dbo.WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE
GO
/****** Object:  View [dbo].[WP_OML_INCREMENT_IN_PRODUCTION_STAGE_1]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_OML_INCREMENT_IN_PRODUCTION_STAGE_1]
AS


SELECT     A.CompanyName, A.Year_of_WP AS Year_of_WP_PREVIOUS,A.Consession_Type, A.Production_SUM AS Production_SUM_PREVIOUS_YEAR, 
                      B.Production_SUM AS Production_SUM_CURRENT_YEAR, B.Year_of_WP , (B.Production_SUM - A.Production_SUM) 
                      / CONVERT(decimal(18, 3), A.Production_SUM) * 100 AS Unscaled_Score
FROM         (SELECT     CompanyName, Year_of_WP, Production_SUM , Consession_Type
                       FROM          (SELECT     CompanyName,Consession_Type, CAST(Year_of_WP AS int) AS Year_of_WP, SUM(CAST(Production AS int)) AS Production_SUM
                                               FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
                                               GROUP BY CompanyName, Year_of_WP , Consession_Type) AS SUB
                       WHERE      (Year_of_WP = YEAR(CURRENT_TIMESTAMP) - 1)) AS A INNER JOIN
                          (SELECT     CompanyName, Year_of_WP, Production_SUM , Consession_Type
                            FROM          (SELECT     CompanyName, CAST(Year_of_WP AS int) AS Year_of_WP, SUM(CAST(Production AS int)) AS Production_SUM , Consession_Type
                                                    FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
                                                    GROUP BY CompanyName, Year_of_WP , Consession_Type) AS SUB
                            WHERE      (Year_of_WP = YEAR(CURRENT_TIMESTAMP))) AS B ON A.CompanyName = B.CompanyName
GO
/****** Object:  View [dbo].[WP_OML_INCREMENT_IN_PRODUCTION_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_INCREMENT_IN_PRODUCTION_INDEX_MN_MAX_RGT_by_YEAR]
AS

SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     a.CompanyName, a.Year_of_WP, a.Consession_Type, a.Unscaled_Score, 
                                              b.Unscaled_Score_sum, ISNULL(a.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), b.Unscaled_Score_sum), 0) * 100, 0) 
                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                      Unscaled_Score
                                               FROM          dbo.WP_OML_INCREMENT_IN_PRODUCTION_STAGE_1) AS a INNER JOIN
                                                  (SELECT     Year_of_WP, Consession_Type, SUM(CAST(Unscaled_Score AS int)) AS Unscaled_Score_sum
                                                   FROM dbo.WP_OML_INCREMENT_IN_PRODUCTION_STAGE_1 AS WP_OML_INCREMENT_IN_PRODUCTION_STAGE_1
                                                    GROUP BY Year_of_WP, Consession_Type) AS b ON a.Year_of_WP = b.Year_of_WP) AS d
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1]
AS

SELECT     CONVERT(VARCHAR(256), CompanyName) AS CompanyName, CONVERT(VARCHAR(256), Year_of_WP) AS Year_of_WP, CONVERT(VARCHAR(256), Consession_Type) 
                      AS Consession_Type, Reserves_as_at_MMbbl, Reserves_as_at_MMbbl_P1, Total_Production_, (CAST(Reserves_as_at_MMbbl AS NUMERIC(20,2) ) 
                      - CAST(Reserves_as_at_MMbbl_P1 AS int)) /  ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Total_Production_),0),1) * 100 AS Unscaled_Score
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, SUM(CAST(Reserves_as_at_MMbbl AS int)) AS Reserves_as_at_MMbbl, 
                                              SUM(CAST(Reserves_as_at_MMbbl_P1 AS NUMERIC(20,2))) AS Reserves_as_at_MMbbl_P1, SUM(CAST(Total_Production_ AS NUMERIC(20,2))) AS Total_Production_
                       FROM          dbo.RESERVES_UPDATES_OIL_CONDENSATE_MMBBL AS RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_1
                       WHERE      (Consession_Type = 'OML') -- and Total_Production_ != 0
                       GROUP BY CompanyName, Year_of_WP, Consession_Type) AS a

GO
/****** Object:  View [dbo].[WP_OML_Reserve_Replacement_Ratio_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Reserve_Replacement_Ratio_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     a.CompanyName, a.Year_of_WP, a.Consession_Type, a.Reserves_as_at_MMbbl_P1, a.Reserves_as_at_MMbbl, a.Total_Production_, a.Unscaled_Score, 
                                              b.Unscaled_Score_sum, ISNULL(a.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), b.Unscaled_Score_sum), 0) * 100, 0) 
                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, Reserves_as_at_MMbbl_P1, Reserves_as_at_MMbbl, Total_Production_, 
                                                                      Unscaled_Score
                                               FROM          dbo.WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1) AS a INNER JOIN
                                                  (SELECT     Year_of_WP, Consession_Type, SUM(CAST(Unscaled_Score AS int)) AS Unscaled_Score_sum
                                                    FROM          dbo.WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1 AS WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1_1
                                                    GROUP BY Year_of_WP, Consession_Type) AS b ON a.Year_of_WP = b.Year_of_WP) AS d
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Reserve_Replacement_Ratio_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Reserve_Replacement_Ratio_INDEX_MN_MAX_RGT_by_YEAR]
AS

SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     a.CompanyName, a.Year_of_WP, a.Consession_Type, a.Reserves_as_at_MMbbl_P1, a.Reserves_as_at_MMbbl, a.Total_Production_, a.Unscaled_Score, 
                                              b.Unscaled_Score_sum, ISNULL(a.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), b.Unscaled_Score_sum), 0) * 100, 0) 
                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, Reserves_as_at_MMbbl_P1, Reserves_as_at_MMbbl, Total_Production_, 
                                                                      Unscaled_Score
                                               FROM          dbo.WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1) AS a INNER JOIN
                                                  (SELECT     Year_of_WP, Consession_Type, SUM(CAST(Unscaled_Score AS NUMERIC(20,2) )) AS Unscaled_Score_sum
                                                    FROM          dbo.WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1 AS WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1_1
                                                    GROUP BY Year_of_WP, Consession_Type) AS b ON a.Year_of_WP = b.Year_of_WP) AS d
GROUP BY Year_of_WP

GO
/****** Object:  View [dbo].[WP_OML_RESERVE_REPLACEMENT_RATIO_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_RESERVE_REPLACEMENT_RATIO_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Reserve Replacement Ratio' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (
                                                                                               
                                                                                              SELECT CompanyName
      ,Year_of_WP
      ,Consession_Type
      ,Reserves_as_at_MMbbl
      ,Reserves_as_at_MMbbl_P1
      ,Total_Production_
      ,Unscaled_Score
  FROM dbo.WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1 
                                                                                                                       
                                                                                                                       
                                                                                                                       ) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (
                                                                                                                            
                                                                                                                     
   SELECT CompanyName
      ,Year_of_WP
      ,Consession_Type
      ,Reserves_as_at_MMbbl
      ,Reserves_as_at_MMbbl_P1
      ,Total_Production_
      ,Unscaled_Score
  FROM dbo.WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1 
                                                                                                                                                    
                                                                                                                                                    ) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Reserve_Replacement_Ratio_INDEX_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Reserve Replacement Ratio')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE]
AS
SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Exploratory Drilling Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                              CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN CATEGORY
                                                                                                                                               = '2nd Appraisal' THEN 100 ELSE '0' END AS Unscaled_Score
                                                                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                                           CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN
                                                                                                                                                                            CATEGORY = '2nd Appraisal' THEN 100 ELSE '0' END AS Unscaled_Score
                                                                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OPL_Exploratory_Drilling_INDEX_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Exploratory Drilling Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Concession_Rentals_Index_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Concession_Rentals_Index_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                              CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.CONCESSION_SITUATION
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                                                           CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.CONCESSION_SITUATION AS CONCESSION_SITUATION_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year, Consession_Type) AS c
                                                    GROUP BY Year) AS E ON D.Year = E.Year) AS F
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_OML_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Concession Rentals Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                                                                                CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.CONCESSION_SITUATION
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year, Has_the_Concession_Rentals_been_paid, Consession_Type, 
                                                                                                                                                                            CASE WHEN Has_the_Concession_Rentals_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.CONCESSION_SITUATION AS CONCESSION_SITUATION_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year, Consession_Type) AS c
                                                                                                    GROUP BY Year) AS E ON D.Year = E.Year) AS F INNER JOIN
                                                                      dbo.WP_OML_Concession_Rentals_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year = G.Year) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Concession Rentals Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_WORKOVERS_RECOMPLETION_JOBS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_WORKOVERS_RECOMPLETION_JOBS]
AS
SELECT     SUM(CAST(Current_year_Actual_Number_data AS decimal)) AS Current_year_Actual_Number_data, SUM(CAST(Proposed_year_data AS decimal)) AS Proposed_year_data, 
                      Year_of_WP
FROM         dbo.WORKOVERS_RECOMPLETION_JOBS
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_INITIAL_WELL_COMPLETION_JOBS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_INITIAL_WELL_COMPLETION_JOBS]
AS
SELECT     SUM(CAST(Current_year_Actual_Number AS decimal)) AS Current_year_Actual_Number, SUM(CAST(Proposed_year_data AS decimal)) AS Proposed_year_data, 
                      Year_of_WP
FROM         dbo.INITIAL_WELL_COMPLETION_JOBS
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_SUM_INITIAL_WELL_COMPLETION_JOBS_WORKOVERS_RECOMPLETION]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_SUM_INITIAL_WELL_COMPLETION_JOBS_WORKOVERS_RECOMPLETION]
AS
SELECT     a.Current_year_Actual_Number_data + b.Current_year_Actual_Number AS Actual_Year, a.Proposed_year_data + b.Proposed_year_data AS Proposed_Year, 
                      a.Year_of_WP AS Year_of_WP_W, b.Year_of_WP AS Year_of_WP_I
FROM         dbo.WP_WORKOVERS_RECOMPLETION_JOBS AS a INNER JOIN
                      dbo.WP_INITIAL_WELL_COMPLETION_JOBS AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_RESERVES_REPLACEMENT_RATIO_VALUE_TO_BE_PIVOTTED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[WP_RESERVES_REPLACEMENT_RATIO_VALUE_TO_BE_PIVOTTED]
AS


SELECT     CompanyName, SUM(CAST(REPLACE(RESERVES_REPLACEMENT_RATIO_VALUE,'%','') AS decimal)) AS RESERVES_REPLACEMENT_RATIO_VALUE, Year_of_WP
FROM         dbo.RESERVES_REPLACEMENT_RATIO
GROUP BY CompanyName, Year_of_WP
GO
/****** Object:  View [dbo].[WP_RESERVES_REPLACEMENT_RATIO_VALUE_PIVOTTED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_RESERVES_REPLACEMENT_RATIO_VALUE_PIVOTTED]
AS

  -- Pivot table with one row and five columns  
SELECT CompanyName AS CompanyName,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT CompanyName , Year_of_WP, RESERVES_REPLACEMENT_RATIO_VALUE   
    FROM WP_RESERVES_REPLACEMENT_RATIO_VALUE_TO_BE_PIVOTTED) AS SourceTable  
PIVOT  
(  
SUM(RESERVES_REPLACEMENT_RATIO_VALUE)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[WP_OML_NDPR_SUBSCRIPTION_FEE_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_NDPR_SUBSCRIPTION_FEE_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Has_annual_NDR_subscription_fee_been_paid, Consession_Type, 
                                                                                              CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.NDPR_SUBSCRIPTION_FEE
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Has_annual_NDR_subscription_fee_been_paid, Consession_Type, 
                                                                                                                           CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.NDPR_SUBSCRIPTION_FEE AS NDPR_SUBSCRIPTION_FEE_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_NDPR_SUBSCRIPTION_FEE_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_NDPR_SUBSCRIPTION_FEE_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'NDR Fee Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.NDPR_SUBSCRIPTION_FEE
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.NDPR_SUBSCRIPTION_FEE AS NDPR_SUBSCRIPTION_FEE_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_NDPR_SUBSCRIPTION_FEE_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'NDR Fee Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_ACQUSITION_INDEX_WEIGHTED_SCORE_OLD2021]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_ACQUSITION_INDEX_WEIGHTED_SCORE_OLD2021]
AS


SELECT     H.CompanyName, H.Quantum_Acquired, H.Quantum_Approved, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Quantum_Acquired, E.Quantum_Approved, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 

                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0)  AS Recalibrated_Scaled_Index, 'Acquisition Index' AS INDEX_TYPE, 'OML' AS Consession_Type
                                              
                                              
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                                                      b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Quantum_Approved),0),1) * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS int)) 
                                                                                                                      AS Quantum_Approved
                                                                                               FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                                               -- where Quantum_Approved != 0
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Quantum_Approved),0),1) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                                                   SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                                            FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                                            WHERE      (Consession_Type = 'OML') -- and Quantum_Approved != 0
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Acquisition Index')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE

GO
/****** Object:  View [dbo].[WP_OML_HSE_ACCIDENT_INCIDENCE_REPORTING_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_HSE_ACCIDENT_INCIDENCE_REPORTING_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Was_there_any_accident_incidence, Consession_Type, 
                                                                                              CASE WHEN Was_there_any_accident_incidence = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_NEW
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Was_there_any_accident_incidence, Consession_Type, 
                                                                                                                           CASE WHEN Was_there_any_accident_incidence = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_NEW_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_HSE_ACCIDENT_INCIDENCE_REPORTING_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_HSE_ACCIDENT_INCIDENCE_REPORTING_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Incidence Reporting' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Was_there_any_accident_incidence = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_NEW
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Was_there_any_accident_incidence = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_NEW_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_HSE_ACCIDENT_INCIDENCE_REPORTING_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Incidence Reporting')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_SIGNATURE_BONUS_Index_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_SIGNATURE_BONUS_Index_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year, Has_Signature_Bonus_been_paid, Consession_Type, 
                                                                                              CASE WHEN Has_Signature_Bonus_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.CONCESSION_SITUATION
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year, Has_Signature_Bonus_been_paid, Consession_Type, 
                                                                                                                           CASE WHEN Has_Signature_Bonus_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.CONCESSION_SITUATION AS CONCESSION_SITUATION_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year, Consession_Type) AS c
                                                    GROUP BY Year) AS E ON D.Year = E.Year) AS F
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_OML_SIGNATURE_BONUS_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_SIGNATURE_BONUS_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Signature Bonus Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year, Consession_Type, 
                                                                                                                                                CASE WHEN Has_Signature_Bonus_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.CONCESSION_SITUATION
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year, Consession_Type, 
                                                                                                                                                                            CASE WHEN Has_Signature_Bonus_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.CONCESSION_SITUATION AS CONCESSION_SITUATION_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year, Consession_Type) AS c
                                                                                                    GROUP BY Year) AS E ON D.Year = E.Year) AS F INNER JOIN
                                                                      dbo.WP_OML_SIGNATURE_BONUS_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year = G.Year) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Signature Bonus Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_COMPLIANCE_INDEX_CALCULATIONS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_OML_COMPLIANCE_INDEX_CALCULATIONS]
AS
SELECT     CompanyName, Consession_Type, Year_of_WP, SUM(Divisional_Sum) AS Total_Sum_All_Division
FROM         (SELECT     Id, CompanyName, Consession_Type, Year_of_WP, Divisions, Penalty_Factor_for_Warning, Number_of_Occurrence_of_Warnings, 
                                              Penalty_Factor_for_Sanction, Number_of_Occurrence_of_Sanctions, Penalty_Factor_for_Waivers, Number_of_Occurrence_of_Waivers, 
                                              Compliance_index_for_each_division, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Warning) / 100, Number_of_Occurrence_of_Warnings) 
                                              AS Penalty_Factor_for_Warning_Calculation, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Sanction) / 100, 
                                              Number_of_Occurrence_of_Sanctions) AS Penalty_Factor_for_Sanction_Calculation, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Waivers) 
                                              / 100, Number_of_Occurrence_of_Waivers) AS Penalty_Factor_for_Waivers_Calculation, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Warning)
                                               / 100, Number_of_Occurrence_of_Warnings) + POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Sanction) / 100, 
                                              Number_of_Occurrence_of_Sanctions) + POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Waivers) / 100, Number_of_Occurrence_of_Waivers) 
                                              AS Divisional_Sum, Created_by, Updated_by, Date_Created, Date_Updated
                       FROM          dbo.ADMIN_COMPLIANCE_INDEX_TABLE
                       WHERE      (Consession_Type = 'OML')) AS a
GROUP BY CompanyName, Consession_Type, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_COMPLIANCE_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_COMPLIANCE_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Compliance Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Total_Sum_All_Division) AS Unscaled_Score
                                                                                               FROM          (
 SELECT CompanyName
      ,Consession_Type
      ,Year_of_WP
      ,Total_Sum_All_Division
  FROM dbo.WP_OML_COMPLIANCE_INDEX_CALCULATIONS WHERE Consession_Type ='OML') AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Total_Sum_All_Division) AS Unscaled_Score
                                                                                                                            FROM          (
                                                                                                                            
SELECT CompanyName
      ,Consession_Type
      ,Year_of_WP
      ,Total_Sum_All_Division
  FROM dbo.WP_OML_COMPLIANCE_INDEX_CALCULATIONS WHERE Consession_Type ='OML'
  
  ) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Compliance Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL]
AS
SELECT DISTINCT a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.Companyemail, b.Total_Production_, b.Year_of_WP
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                      dbo.RESERVES_UPDATES_OIL_CONDENSATE_MMBBL AS b ON a.COMPANY_EMAIL = b.Companyemail
GO
/****** Object:  View [dbo].[VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_total_4_percentage_calculation]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_total_4_percentage_calculation]
AS
SELECT     Total_Production_, Year_of_WP
FROM         (SELECT     SUM(CAST(Total_Production_ AS int)) AS Total_Production_, Year_of_WP
                       FROM          dbo.VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL
                       GROUP BY Year_of_WP) AS d
GO
/****** Object:  View [dbo].[VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_PERCENTAGE_CALCULATED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_PERCENTAGE_CALCULATED]
AS
SELECT     c.Contract_Type, c.Total_Production_, c.Year_of_WP, d.Total_Production_ AS Total_Production_percentage, d.Year_of_WP AS Year_of_WP_percentage, 
                      c.Total_Production_ / d.Total_Production_ * 100 AS Percantage_Production
FROM         (SELECT     Contract_Type, SUM(CAST(Total_Production_ AS int)) AS Total_Production_, Year_of_WP
                       FROM          dbo.VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL
                       GROUP BY Contract_Type, Year_of_WP) AS c CROSS JOIN
                      dbo.VW_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_total_4_percentage_calculation AS d
GO
/****** Object:  View [dbo].[WP_OML_ACQUSITION_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[WP_OML_ACQUSITION_INDEX_WEIGHTED_SCORE]
AS


SELECT     H.CompanyName, H.Quantum_Acquired, H.Quantum_Approved, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Quantum_Acquired, E.Quantum_Approved, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 

                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0)  AS Recalibrated_Scaled_Index, 'Acquisition Index' AS INDEX_TYPE, 'OML' AS Consession_Type
                                              
                                              
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                                                     -- b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
																	  ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved,
											   
											   -- Quantum_Acquired / ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Quantum_Approved),0),1) * 100 AS Unscaled_Score
											    ISNULL( Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score

                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS NUMERIC(20,2) )) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS NUMERIC(20,2) )) 
                                                                                                                      AS Quantum_Approved
                                                                                               FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                                               -- where Quantum_Approved != 0
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved,
																			
																				-- Quantum_Acquired / ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Quantum_Approved),0),1) * 100 AS Unscaled_Score
																				 ISNULL( Quantum_Acquired / NULLIF(Quantum_Approved, 0), 0)  * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS NUMERIC(20,2) )) AS Quantum_Acquired, 
                                                                                                                                                   SUM(CAST(Quantum_Approved AS NUMERIC(20,2) )) AS Quantum_Approved
                                                                                                                            FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                                            WHERE      (Consession_Type = 'OML') -- and Quantum_Approved != 0
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Acquisition Index')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE

GO
/****** Object:  View [dbo].[WP_OML_Facility_Project_Performance_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Facility_Project_Performance_INDEX_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											    ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP,  Utilized, Produced,
					   
					   --Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score

					    ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(Planned_completion AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.FACILITIES_PROJECT_PERFORMANCE
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced,
													
													-- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score

													 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(Planned_completion AS NUMERIC(20,2) )) AS Produced
                                                                                                    FROM          dbo.FACILITIES_PROJECT_PERFORMANCE AS FACILITIES_PROJECT_PERFORMANCE_1
                                                                                                  WHERE Consession_Type = 'OML'
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP


GO
/****** Object:  View [dbo].[WP_OML_Facility_Project_Performance_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Facility_Project_Performance_INDEX_WEIGHTED_SCORE]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Facilities Project Performance' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 

                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											 ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced,
											   
																	--Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
																	 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(Planned_completion AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.FACILITIES_PROJECT_PERFORMANCE
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
																			
																			-- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
																			 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(Planned_completion AS NUMERIC(20,2) )) AS Produced
                                                                                                    FROM          dbo.FACILITIES_PROJECT_PERFORMANCE AS FACILITIES_PROJECT_PERFORMANCE_1
                                                                                                                            WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP)AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Facility_Project_Performance_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Facilities Project Performance')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Discovery_Index_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Discovery_Index_MN_MAX_RGT_by_YEAR]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT


                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                              CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                                                           CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_DISCOVERY_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_DISCOVERY_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Discovery Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                                            CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Discovery_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Discovery Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE_OLD]
AS
SELECT     H.CompanyName, H.Quantum_Acquired, H.Quantum_Approved, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Quantum_Acquired, E.Quantum_Approved, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + (E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) 
                                              * (100 - 0), 0) AS Recalibrated_Scaled_Index, 'Acquisition Index' AS INDEX_TYPE, 'OPL' AS Consession_Type
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                                                      b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), 
                                                                                              Quantum_Approved) * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS int)) 
                                                                                                                      AS Quantum_Approved
                                                                                               FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), 
                                                                                                                           Quantum_Approved) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                                                   SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                                            FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                                            WHERE      (Consession_Type = 'OPL')
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OPL_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OPL') AND (INDEX_TYPE = 'Acquisition Index')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Has_annual_NDR_subscription_fee_been_paid_new_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Has_annual_NDR_subscription_fee_been_paid_new_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Has_annual_NDR_subscription_fee_been_paid, Consession_Type, 
                                                                                              CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Has_annual_NDR_subscription_fee_been_paid, Consession_Type, 
                                                                                                                           CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Has_annual_NDR_subscription_fee_been_paid_new_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Has_annual_NDR_subscription_fee_been_paid_new_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'NDR Fee Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Has_annual_NDR_subscription_fee_been_paid = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Has_annual_NDR_subscription_fee_been_paid_new_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'NDR Fee Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Gas_Sales_Royalty_Payment_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Gas_Sales_Royalty_Payment_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Gas_Sales_Royalty_Payment, Consession_Type, 
                                                                                              CASE WHEN Gas_Sales_Royalty_Payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Gas_Sales_Royalty_Payment, Consession_Type, 
                                                                                                                           CASE WHEN Gas_Sales_Royalty_Payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Gas_Sales_Royalty_Payment_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Gas_Sales_Royalty_Payment_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Gas Sales Royalty Payment Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Gas_Sales_Royalty_Payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Gas_Sales_Royalty_Payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Gas_Sales_Royalty_Payment_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Gas Sales Royalty Payment Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Gas_flare_Royalty_payment_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Gas_flare_Royalty_payment_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Gas_flare_Royalty_payment, Consession_Type, 
                                                                                              CASE WHEN Gas_flare_Royalty_payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Gas_flare_Royalty_payment, Consession_Type, 
                                                                                                                           CASE WHEN Gas_flare_Royalty_payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Gas_flare_Royalty_payment_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Gas_flare_Royalty_payment_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Gas Flare Penalty Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Gas_flare_Royalty_payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Gas_flare_Royalty_payment = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Gas_flare_Royalty_payment_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Gas Flare Penalty Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Domestic_Gas_obligation_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Domestic_Gas_obligation_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Domestic_Gas_obligation_met, Consession_Type, 
                                                                                              CASE WHEN Domestic_Gas_obligation_met = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Domestic_Gas_obligation_met, Consession_Type, 
                                                                                                                           CASE WHEN Domestic_Gas_obligation_met = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Domestic_Gas_obligation_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Domestic_Gas_obligation_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Domestic Gas Obligation (DomGas)' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Domestic_Gas_obligation_met = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Domestic_Gas_obligation_met = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Domestic_Gas_obligation_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Domestic Gas Obligation (DomGas)')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_Cost_Efficiency_Metric_CAPEX_OPEX]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_Cost_Efficiency_Metric_CAPEX_OPEX]
AS

--SELECT     CompanyName, Year_of_WP, SUM(CAST(naira AS int)) AS naira , Consession_Type

SELECT     CompanyName, Year_of_WP, SUM(CAST(naira AS decimal(18, 2))) AS naira , Consession_Type

FROM dbo.BUDGET_CAPEX_OPEX WHERE Consession_Type = 'OML'

GROUP BY CompanyName, Year_of_WP , Consession_Type
GO
/****** Object:  View [dbo].[WP_Cost_Efficiency_Metric_NET_PRODUCTION]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_Cost_Efficiency_Metric_NET_PRODUCTION]
AS

SELECT     CompanyName, Year_of_WP, SUM(CAST(Production AS decimal(18, 2)))AS Production , Consession_Type
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
WHERE     (Consession_Type = 'OML')
GROUP BY CompanyName, Year_of_WP , Consession_Type
GO
/****** Object:  View [dbo].[WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION]
AS
SELECT     dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX.CompanyName, dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX.Year_of_WP, 
                      dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX.naira AS CAPEX_PLUS_OPEX, dbo.WP_Cost_Efficiency_Metric_NET_PRODUCTION.Production
FROM         dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX INNER JOIN
                      dbo.WP_Cost_Efficiency_Metric_NET_PRODUCTION ON 
                      dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX.CompanyName = dbo.WP_Cost_Efficiency_Metric_NET_PRODUCTION.CompanyName AND 
                      dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX.Year_of_WP = dbo.WP_Cost_Efficiency_Metric_NET_PRODUCTION.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_MN_MAX_RGT_by_YEAR]
AS

SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.CAPEX_PLUS_OPEX, b.Production, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                             -- b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
											   ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production,
					   
					--   Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) * 100 AS Unscaled_Score
																	    ISNULL( Production / NULLIF(CAPEX_PLUS_OPEX, 0), 0)  * 100 AS Unscaled_Score


                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(CAPEX_PLUS_OPEX AS  NUMERIC(20,2) )) AS CAPEX_PLUS_OPEX, SUM(CAST(Production AS  NUMERIC(20,2) )) 
                                                                                              AS Production
                                                                       FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production,
													
													--Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) * 100 AS Unscaled_Score
													
											  ISNULL( Production / NULLIF(CAPEX_PLUS_OPEX, 0), 0)  * 100 AS Unscaled_Score


                                                                            FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production
                                                                                                    FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION AS WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION_1)
                                                                                                    AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP


GO
/****** Object:  View [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_WEIGHTED_SCORE]
AS

SELECT     H.CompanyName, H.CAPEX_PLUS_OPEX, H.Production, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, H.Year_of_WP, 
                      H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.CAPEX_PLUS_OPEX, E.Production, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) 
                                              / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 'Cost Efficiency Metric' AS INDEX_TYPE, 
                                              'OML' AS Consession_Type
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.CAPEX_PLUS_OPEX, b.Production, b.Unscaled_Score, d.Unscaled_Score_sum, 

                                                                     -- b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

																	   ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                                               FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production,
											   
														--	Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) * 100 AS Unscaled_Score
															 ISNULL( Production / NULLIF(CAPEX_PLUS_OPEX, 0), 0)  * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAPEX_PLUS_OPEX) AS CAPEX_PLUS_OPEX, SUM(Production) AS Production
                                                                                               FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX,	Production,
																			
																			-- Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) * 100 AS Unscaled_Score
																			 ISNULL( Production / NULLIF(CAPEX_PLUS_OPEX, 0), 0)  * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production
                                                                                                                            FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION AS WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION_1)
                                                                                                                            AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OPL_OML_Cost_Efficiency_Metric_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Cost Efficiency Metric')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE


GO
/****** Object:  View [dbo].[WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE_OLD]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Discovery Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.DRILLING_OPERATIONS_
                                                                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                                            CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.DRILLING_OPERATIONS_ AS DRILLING_OPERATIONS_1
                                                                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OPL') AND (INDEX_TYPE = 'Discovery Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_Aggregated_Score_ALL_COMPANIES_WITHOUT_INDEX_TYPE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OPL_Aggregated_Score_ALL_COMPANIES_WITHOUT_INDEX_TYPE]
AS
SELECT     CompanyName, Consession_Type, Year_of_WP, Recalibrated_Scaled_Index_SUM, Weight_SUM, Weighted_Score_SUM, 
                     -- Weighted_Score_SUM / CONVERT(decimal(18, 3), Weight_SUM) AS OPL_Aggregated_Score

					    ISNULL(Weighted_Score_SUM / NULLIF(Weight_SUM, 0), 0) AS OPL_Aggregated_Score
FROM         (SELECT     CompanyName, Consession_Type, Year_of_WP, SUM(CAST(Recalibrated_Scaled_Index AS NUMERIC(20,2) )) AS Recalibrated_Scaled_Index_SUM, 
                                              SUM(CAST(Weight AS NUMERIC(20,2) )) AS Weight_SUM, SUM(CAST(Weighted_Score AS NUMERIC(20,2) )) AS Weighted_Score_SUM
                       FROM          (SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM          dbo.WP_OPL_ACQUSITION_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               --SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               --FROM         dbo.WP_OPL_COMPLIANCE_INDEX_WEIGHTED_SCORE
                                               --UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_EXPLORATORY_DRILLING_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year_of_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_DISCOVERY_INDEX_WEIGHTED_SCORE
                                               UNION ALL
                                               SELECT     CompanyName, Consession_Type, Year AS YEAR_OF_WP, INDEX_TYPE, Recalibrated_Scaled_Index, Weight, Weighted_Score
                                               FROM         dbo.WP_OPL_CONCESSION_RENTALS_INDEX_WEIGHTED_SCORE) AS SUM_ALL
                       GROUP BY CompanyName, Consession_Type, Year_of_WP) AS OPL_Aggregated_Score
GO
/****** Object:  View [dbo].[WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Consequence, Consession_Type, 
                                                                                                                           CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                              --  ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                    WHERE      (Consession_Type = 'OML')
                                                                                                   ) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (
                                                                            SELECT     CompanyName, Year_of_WP, Consequence, Consession_Type, 
                                                                                                                           CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                   WHERE      (Consession_Type = 'OML')
                                                                                                    ) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP
                                                                            , Consession_Type
                                                                            ) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_FATALITY_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_FATALITY_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Fatality Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                               
                                                                                                                               CASE WHEN Consequence = 'FATALITY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
                                                                                                                      -- WHERE      (Consession_Type = 'OML')
                                                                                                                      ) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                            
                                                                                                                             CASE WHEN Consequence = 'FATALITY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                                                                  --  WHERE      (Consession_Type = 'OML')
                                                                                                                                                  ) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Fatality Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES]
AS
SELECT DISTINCT 
                      a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.Year_of_WP, b.Current_year_Actual, b.Deferment, b.Forecast, b.Cost_Barrel, b.Companyemail
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                      dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES AS b ON a.COMPANY_EMAIL = b.Companyemail
GO
/****** Object:  View [dbo].[VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_total]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_total]
AS
SELECT     Contract_Type, SUM(CAST(Current_year_Actual AS int)) AS Current_year_Actual, SUM(CAST(Deferment AS int)) AS Deferment, SUM(CAST(Forecast AS int)) AS Forecast, 
                      SUM(CAST(Cost_Barrel AS int)) AS Cost_Barrel, Year_of_WP
FROM         dbo.VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES
GROUP BY Contract_Type, Year_of_WP
GO
/****** Object:  View [dbo].[VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_total_summed]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_total_summed]
AS
SELECT     Year_of_WP, SUM(Current_year_Actual) AS Current_year_Actual, SUM(Deferment) AS Deferment, SUM(Forecast) AS Forecast, SUM(Cost_Barrel) AS Cost_Barrel
FROM         dbo.VW_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_total
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.CAPEX_PLUS_OPEX, b.Production, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production, Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(CAPEX_PLUS_OPEX AS int)) AS CAPEX_PLUS_OPEX, SUM(CAST(Production AS int)) 
                                                                                              AS Production
                                                                       FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production, Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) 
                                                                                                   * 100 AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production
                                                                                                    FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION AS WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION_1)
                                                                                                    AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Facility_Project_Performance_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Facility_Project_Performance_INDEX_WEIGHTED_SCORE_OLD]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Facilities Project Performance' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS int)) AS Utilized, SUM(CAST(Planned_completion AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.FACILITIES_PROJECT_PERFORMANCE
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(Planned_completion AS int)) AS Produced
                                                                                                    FROM          dbo.FACILITIES_PROJECT_PERFORMANCE AS FACILITIES_PROJECT_PERFORMANCE_1
                                                                                                                            WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP)AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Facility_Project_Performance_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Facilities Project Performance')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[VW_HSE_OIL_SPILL_REPORTING_NEW]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_HSE_OIL_SPILL_REPORTING_NEW]
AS
SELECT DISTINCT a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.Year_of_WP, b.Volume_of_spill_bbls, b.Volume_recovered_bbls, b.Companyemail
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                      dbo.HSE_OIL_SPILL_REPORTING_NEW AS b ON a.COMPANY_EMAIL = b.Companyemail
GO
/****** Object:  View [dbo].[VW_HSE_OIL_SPILL_REPORTING_NEW_total]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_HSE_OIL_SPILL_REPORTING_NEW_total]
AS
SELECT     Contract_Type, Year_of_WP, SUM(CAST(Volume_of_spill_bbls AS int)) AS Volume_of_spill_bbls, SUM(CAST(Volume_recovered_bbls AS int)) 
                      AS Volume_recovered_bbls
FROM         dbo.VW_HSE_OIL_SPILL_REPORTING_NEW
GROUP BY Contract_Type, Year_of_WP
GO
/****** Object:  View [dbo].[VW_HSE_OIL_SPILL_REPORTING_NEW_total_summed]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[VW_HSE_OIL_SPILL_REPORTING_NEW_total_summed]
AS
SELECT     Year_of_WP, SUM(Volume_of_spill_bbls) AS Volume_of_spill_bbls, SUM(Volume_recovered_bbls) AS Volume_recovered_bbls
FROM         dbo.VW_HSE_OIL_SPILL_REPORTING_NEW_total
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced,
					   
					   -- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
					    ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(total_no_of_senior_staff AS NUMERIC(20,2))) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
													
												--	Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
												 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                                                            FROM          (
                                                                          

															 SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_senior_staff AS NUMERIC(20,2))) AS Produced , Consession_Type
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                      WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                    
                                                                                                    ) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Senior_Staff_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Senior_Staff_INDEX_WEIGHTED_SCORE_OLD]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Senior Staff' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, SUM(CAST(total_no_of_senior_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_senior_staff AS int)) AS Produced
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                          --  WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP)AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Senior Staff')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_OML_Cost_Efficiency_Metric_INDEX_WEIGHTED_SCORE_OLD]
AS
SELECT     H.CompanyName, H.CAPEX_PLUS_OPEX, H.Production, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, H.Year_of_WP, 
                      H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.CAPEX_PLUS_OPEX, E.Production, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                              F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) 
                                              / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 'Cost Efficiency Metric' AS INDEX_TYPE, 
                                              'OML' AS Consession_Type
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.CAPEX_PLUS_OPEX, b.Production, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                                                      b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production, Production / CONVERT(decimal(18, 1), CAPEX_PLUS_OPEX) 
                                                                                              * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAPEX_PLUS_OPEX) AS CAPEX_PLUS_OPEX, SUM(Production) AS Production
                                                                                               FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production, Production / CONVERT(decimal(18, 1), 
                                                                                                                           CAPEX_PLUS_OPEX) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, CAPEX_PLUS_OPEX, Production
                                                                                                                            FROM          dbo.WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION AS WP_Cost_Efficiency_Metric_CAPEX_OPEX_PRODUCTION_1)
                                                                                                                            AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OPL_OML_Cost_Efficiency_Metric_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Cost Efficiency Metric')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Senior_Staff_INDEX_WEIGHTED_SCORE_OLD2021]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Senior_Staff_INDEX_WEIGHTED_SCORE_OLD2021]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Senior Staff' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, SUM(CAST(total_no_of_senior_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                                                    FROM          (  
                                                                                                    

																									SELECT  CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_senior_staff AS int)) AS Produced , Consession_Type
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                      WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                                            
                                                                                                                            )AS a_1   ) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Senior Staff')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_GAS_Utilisation_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[WP_OML_GAS_Utilisation_INDEX_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                             -- b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											  ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced,
					   
					   --Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score

					    ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(Current_Actual_Year AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
													
												--	Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score

												 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(Current_Actual_Year AS NUMERIC(20,2) )) AS Produced
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                    WHERE      (Consession_Type = 'OML')
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP


GO
/****** Object:  View [dbo].[WP_OML_GAS_Utilisation_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[WP_OML_GAS_Utilisation_INDEX_WEIGHTED_SCORE]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Gas Utilisation' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											 ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced,
											   
											--   Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
											 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(Current_Actual_Year AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
																			-- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
																			 ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(Current_Actual_Year AS NUMERIC(20,2) )) AS Produced
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                                            WHERE      (Consession_Type = 'OML')
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_GAS_Utilisation_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Gas Utilisation')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_INJURY_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_INJURY_INDEX_WEIGHTED_SCORE_OLD]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Injury Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                               
                                                                                                                               CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
                                                                                                                      -- WHERE      (Consession_Type = 'OML')
                                                                                                                      ) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                            
                                                                                                                             CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                                                                  --  WHERE      (Consession_Type = 'OML')
                                                                                                                                                  ) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Injury Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_INJURY_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_INJURY_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Injury Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                               
                                                                                                                               CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
                                                                                                                       WHERE      (Consession_Type = 'OML')
                                                                                                                      ) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                            
                                                                                                                             CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                                                                   WHERE      (Consession_Type = 'OML')
                                                                                                                                                  ) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Injury Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											  ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
					   -- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
					   	ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(total_no_of_top_management_staff AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
													
												--	Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
													ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                                                            FROM          (
                                                                            
                                                                                                                                                                             
                                                                                                      SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_top_management_staff AS NUMERIC(20,2) )) AS Produced , Consession_Type
                                                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                         WHERE      Consession_Type = 'OML'
                                                                                                                         GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                                            
                                                                                                                            
                                                                                                    
                                                                                                    ) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Top_Management_Staff_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Top_Management_Staff_INDEX_WEIGHTED_SCORE_OLD]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Top Management' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, SUM(CAST(total_no_of_top_management_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_top_management_staff AS int)) AS Produced
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                          --  WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP)AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR ) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Top Management')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Top_Management_Staff_INDEX_WEIGHTED_SCORE_OLD2021]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Top_Management_Staff_INDEX_WEIGHTED_SCORE_OLD2021]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Top Management' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, SUM(CAST(total_no_of_top_management_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                                                    FROM          (
                                                                                                    
                                                                                                    SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_top_management_staff AS int)) AS Produced , Consession_Type
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                         WHERE      Consession_Type = 'OML'
                                                                                                                         GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                                            
                                                                                                                            
                                                                                                                            
                                                                                                                            )AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR ) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Top Management')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_consequence_is_spill_total]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*,Cause ---ORDER BY Year_of_WP*/
CREATE VIEW [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_consequence_is_spill_total]
AS
SELECT     SUM(CAST(Frequency AS int)) AS sum_accident, Year_of_WP, Consequence
FROM         dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
WHERE     (Consequence = 'SPILL') AND (Cause IN ('EQUIPMENT FAILURE', 'HUMAN ERROR', 'MYSTERY SPILLS', 'SABOTAGE'))
GROUP BY Year_of_WP, Consequence
GO
/****** Object:  View [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_consequence_is_spill]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_consequence_is_spill]
AS
SELECT     SUM(CAST(Frequency AS int)) AS sum_accident, Year_of_WP, Consequence, Cause
FROM         dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
WHERE     (Consequence = 'SPILL') AND (Cause IN ('EQUIPMENT FAILURE', 'HUMAN ERROR', 'MYSTERY SPILLS', 'SABOTAGE'))
GROUP BY Year_of_WP, Consequence, Cause
GO
/****** Object:  View [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_total_spill_accident_and_percentages]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_total_spill_accident_and_percentages]
AS
SELECT     a.sum_accident AS [sum_accident_from total], a.Year_of_WP, a.Consequence, b.sum_accident, CONVERT(decimal(18, 3), b.sum_accident) / CONVERT(decimal(18, 3), 
                      NULLIF(a.sum_accident, 0)) * 100 AS Percentage_Spill, b.Year_of_WP AS Year_of_WP_from_total, b.Consequence AS Expr1, b.Cause
FROM         dbo.WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_consequence_is_spill_total AS a INNER JOIN
                      dbo.WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_consequence_is_spill AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[VW_Geophysical_SEISMIC_DATA]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_Geophysical_SEISMIC_DATA]
AS
SELECT     d.CompanyName, d.Contract_Type, d.COMPANY_EMAIL, d.Actual_year_aquired_data_ACQUISITION, d.proposed_year_data_ACQUISITION, 
                      d.CompanyName AS companyname_ACQUISITION, d.companyemail_ACQUISITION, d.Year_ACQUISITION, 
                      c.Actual_year_aquired_data AS Actual_year_aquired_data_PROCESSING, c.proposed_year_data AS proposed_year_data_PROCESSING, 
                      c.CompanyName AS companyname_PROCESSING, c.Companyemail AS companyemail_PROCESSING, c.Year_of_WP AS Year_PROCESSING
FROM         (SELECT DISTINCT 
                                              a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.Actual_year_aquired_data AS Actual_year_aquired_data_ACQUISITION, 
                                              b.proposed_year_data AS proposed_year_data_ACQUISITION, b.CompanyName AS companyname_ACQUISITION, 
                                              b.Companyemail AS companyemail_ACQUISITION, b.Year_of_WP AS Year_ACQUISITION
                       FROM          dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                                              dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS b ON a.COMPANY_EMAIL = b.Companyemail) AS d INNER JOIN
                      dbo.GEOPHYSICAL_ACTIVITIES_PROCESSING AS c ON d.Year_ACQUISITION = c.Year_of_WP AND d.companyemail_ACQUISITION = c.Companyemail
GO
/****** Object:  View [dbo].[VW_Geophysical_SEISMIC_DATA_total]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_Geophysical_SEISMIC_DATA_total]
AS
SELECT     Contract_Type, SUM(CAST(Actual_year_aquired_data_ACQUISITION AS int)) AS Actual_year_aquired_data_ACQUISITION, 
                      SUM(CAST(proposed_year_data_ACQUISITION AS int)) AS proposed_year_data_ACQUISITION, SUM(CAST(Actual_year_aquired_data_PROCESSING AS int)) 
                      AS Actual_year_aquired_data_PROCESSING, SUM(CAST(proposed_year_data_PROCESSING AS int)) AS proposed_year_data_PROCESSING, Year_ACQUISITION
FROM         dbo.VW_Geophysical_SEISMIC_DATA
GROUP BY Contract_Type, Year_ACQUISITION
GO
/****** Object:  View [dbo].[VW_Geophysical_SEISMIC_DATA_total_summed]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_Geophysical_SEISMIC_DATA_total_summed]
AS
SELECT     Year_ACQUISITION, SUM(Actual_year_aquired_data_ACQUISITION) AS Actual_year_aquired_data_ACQUISITION, SUM(proposed_year_data_ACQUISITION) 
                      AS proposed_year_data_ACQUISITION, SUM(Actual_year_aquired_data_PROCESSING) AS Actual_year_aquired_data_PROCESSING, 
                      SUM(proposed_year_data_PROCESSING) AS proposed_year_data_PROCESSING
FROM         dbo.VW_Geophysical_SEISMIC_DATA_total
GROUP BY Year_ACQUISITION
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT]
AS
SELECT     OML_ID, OML_Name, CompanyName, Companyemail, Year_of_WP, MAX(CASE WHEN Category = 'Exploration' THEN Actual_no_drilled_in_current_year END) 
                      AS Exploration_Actual, MAX(CASE WHEN Category = 'Development' THEN Actual_no_drilled_in_current_year END) AS Development_Actual, 
                      MAX(CASE WHEN Category = 'Appraisal' THEN Actual_no_drilled_in_current_year END) AS Appraisal_Actual, 
                      MAX(CASE WHEN Category = 'Exploration' THEN Proposed_No_Drilled END) AS Exploration_Proposed, 
                      MAX(CASE WHEN Category = 'Development' THEN Proposed_No_Drilled END) AS Development_Proposed, 
                      MAX(CASE WHEN Category = 'Appraisal' THEN Proposed_No_Drilled END) AS Appraisal_Proposed
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
GROUP BY OML_ID, OML_Name, CompanyName, Companyemail, Year_of_WP
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_by_year_companyemail]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_by_year_companyemail]
AS
SELECT     Companyemail, Year_of_WP, SUM(CAST(Exploration_Actual AS int)) AS Exploration_Actual, SUM(CAST(Development_Actual AS int)) AS Development_Actual, 
                      SUM(CAST(Appraisal_Actual AS int)) AS Appraisal_Actual, SUM(CAST(Exploration_Proposed AS int)) AS Exploration_Proposed, 
                      SUM(CAST(Development_Proposed AS int)) AS Development_Proposed, SUM(CAST(Appraisal_Proposed AS int)) AS Appraisal_Proposed
FROM         dbo.VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT
GROUP BY Companyemail, Year_of_WP
GO
/****** Object:  View [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type]
AS
SELECT     COUNT(Contract_Type) AS Count_Contract_Type, Contract_Type, Year_of_WP, Geo_type_of_data_acquired
FROM         dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
GROUP BY Contract_Type, Year_of_WP, Geo_type_of_data_acquired
GO
/****** Object:  View [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type]
AS
SELECT     Geo_type_of_data_acquired, SUM(CAST(Actual_year_aquired_data AS decimal)) AS Actual_year_aquired_data, SUM(CAST(proposed_year_data AS decimal)) 
                      AS proposed_year_data, Year_of_WP, Contract_Type
FROM         dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
GROUP BY Geo_type_of_data_acquired, Year_of_WP, Contract_Type
GO
/****** Object:  View [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_and_count]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_and_count]
AS
SELECT     dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Count_Contract_Type, 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Contract_Type, 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Year_of_WP, 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Geo_type_of_data_acquired, 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type.Actual_year_aquired_data, 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type.proposed_year_data
FROM         dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type INNER JOIN
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type ON 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Contract_Type = dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type.Contract_Type
                       AND 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Year_of_WP = dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type.Year_of_WP
                       AND 
                      dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_count_contract_type.Geo_type_of_data_acquired = dbo.WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION_sum_contract_type.Geo_type_of_data_acquired
GO
/****** Object:  View [dbo].[WP_OML_Oil_spill_reported_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Oil_spill_reported_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Oil_spill_reported, Consession_Type, 
                                                                                              CASE WHEN Oil_spill_reported = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.HSE_COMMUNITY_DISTURBANCES_AND_OIL_SPILL_COST_NEW
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Oil_spill_reported, Consession_Type, 
                                                                                                                           CASE WHEN Oil_spill_reported = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_COMMUNITY_DISTURBANCES_AND_OIL_SPILL_COST_NEW AS HSE_COMMUNITY_DISTURBANCES_AND_OIL_SPILL_COST_NEW_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                                                    
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Oil_spill_reported_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Oil_spill_reported_INDEX_WEIGHTED_SCORE]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Cause of Spill' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                CASE WHEN Oil_spill_reported = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.HSE_COMMUNITY_DISTURBANCES_AND_OIL_SPILL_COST_NEW
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consession_Type, 
                                                                                                                                                                            CASE WHEN Oil_spill_reported = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.HSE_COMMUNITY_DISTURBANCES_AND_OIL_SPILL_COST_NEW AS HSE_COMMUNITY_DISTURBANCES_AND_OIL_SPILL_COST_NEW_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Oil_spill_reported_Index_MN_MAX_RGT_by_Year_of_WP AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Cause of Spill')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_by_year]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_by_year]
AS
SELECT     Year_of_WP, SUM(CAST(Exploration_Actual AS int)) AS Exploration_Actual, SUM(CAST(Development_Actual AS int)) AS Development_Actual, 
                      SUM(CAST(Appraisal_Actual AS int)) AS Appraisal_Actual, SUM(CAST(Exploration_Proposed AS int)) AS Exploration_Proposed, 
                      SUM(CAST(Development_Proposed AS int)) AS Development_Proposed, SUM(CAST(Appraisal_Proposed AS int)) AS Appraisal_Proposed
FROM         dbo.VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME]
AS
SELECT     CompanyName, Year_of_WP, SUM(CAST(Frequency AS decimal)) AS Frequency
FROM         dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
GROUP BY CompanyName, Year_of_WP
GO
/****** Object:  View [dbo].[WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME]
AS
SELECT     CompanyName, Year_of_WP, SUM(CAST(Total_Quantity_Spilled AS decimal)) AS Total_Quantity_Spilled, SUM(CAST(Total_Quantity_Recovered AS decimal)) 
                      AS Total_Quantity_Recovered
FROM         dbo.HSE_CAUSES_OF_SPILL
GROUP BY CompanyName, Year_of_WP
GO
/****** Object:  View [dbo].[WP_TOTAL_INCIDENCE_AND_OIL_SPILL_AND_RECOVERED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_TOTAL_INCIDENCE_AND_OIL_SPILL_AND_RECOVERED]
AS
SELECT     dbo.WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME.CompanyName, dbo.WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME.Year_of_WP, 
                      dbo.WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME.Frequency, 
                      dbo.WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME.Total_Quantity_Spilled, 
                      dbo.WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME.Total_Quantity_Recovered
FROM         dbo.WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME INNER JOIN
                      dbo.WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME ON 
                      dbo.WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME.CompanyName = dbo.WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME.CompanyName
                       AND 
                      dbo.WP_TOTAL_NO_OF_INCIDENCE_BY_YEAR_COMPANYNAME.Year_of_WP = dbo.WP_TOTAL_NO_OF_OIL_SPILLED_AND_RECOVERED_BY_YEAR_COMPANYNAME.Year_of_WP
GO
/****** Object:  View [dbo].[VW_GEOPHYSICAL_ACTIVITIES_PROCESSING]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_GEOPHYSICAL_ACTIVITIES_PROCESSING]
AS
SELECT     a.OML_Name, a.CompanyName, a.Companyemail, a.Year, a.Geological_location, b.Geo_Type_of_Data_being_Processed, b.Geo_Quantum_of_Data, 
                      b.Geo_Completion_Status, b.OML_Name AS OML_Name_, b.Companyemail AS companyemail_, b.Year_of_WP
FROM         dbo.CONCESSION_SITUATION AS a INNER JOIN
                      dbo.GEOPHYSICAL_ACTIVITIES_PROCESSING AS b ON a.OML_Name = b.OML_Name AND a.Companyemail = b.Companyemail AND a.Year = b.Year_of_WP
GO
/****** Object:  View [dbo].[VW_GEOPHYSICAL_ACTIVITIES_PROCESSING_SUM_BY_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_GEOPHYSICAL_ACTIVITIES_PROCESSING_SUM_BY_YEAR]
AS
SELECT     Year, SUM(CAST(Geo_Quantum_of_Data AS int)) AS Geo_Quantum_of_Data
FROM         dbo.VW_GEOPHYSICAL_ACTIVITIES_PROCESSING
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR_STATUS_COMPANYNAME]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR_STATUS_COMPANYNAME]
AS
SELECT     TOP (100) PERCENT COUNT(Status_) AS count, Year, Status_, CompanyName
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION
GROUP BY Year, Status_, CompanyName
ORDER BY Year
GO
/****** Object:  View [dbo].[WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR]
AS
SELECT     TOP (100) PERCENT COUNT(Status_) AS count, Year, Status_
FROM         dbo.WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR_STATUS_COMPANYNAME
WHERE     (Status_ IN ('presented', 'Failed to show up', 'Update Required', 'Showed up but could not present', 'Not invited'))
GROUP BY Year, Status_
ORDER BY Year
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_terrain_tobe_pivotted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_terrain_tobe_pivotted]
AS
SELECT     Terrain, SUM(CAST(Current_Actual_Year AS decimal)) AS Annual_Total_Production_by_Terrain, Year_of_WP
FROM         dbo.GAS_PRODUCTION_ACTIVITIES
GROUP BY Terrain, Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_terrain_pivotted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_terrain_pivotted]
AS

  -- Pivot table with one row and five columns  
SELECT Terrain AS Terrain,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT Terrain , Year_of_WP, Annual_Total_Production_by_Terrain   
    FROM WP_GAS_PRODUCTION_ACTIVITIES_terrain_tobe_pivotted) AS SourceTable  
PIVOT  
(  
SUM(Annual_Total_Production_by_Terrain)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES]
AS
--WITH params AS (select Sum(CAST(Utilized AS decimal)) AS util  from dbo.GAS_PRODUCTION_ACTIVITIES where ISNUMERIC(Utilized) = 1)
SELECT     Year_of_WP, SUM(CAST(Current_Actual_Year AS decimal)) AS Actual_Total_Gas_Produced, SUM(CAST(Flared AS decimal))
                       AS Flared_Gas_Produced, (select Sum(CAST(Utilized AS decimal)) AS util  from dbo.GAS_PRODUCTION_ACTIVITIES where ISNUMERIC(Utilized) = 1) AS Utilized_Gas_Produced
FROM         dbo.GAS_PRODUCTION_ACTIVITIES
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_Percentages]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_Percentages]
AS
SELECT     Year_of_WP, Actual_Total_Gas_Produced, Utilized_Gas_Produced, Flared_Gas_Produced, CONVERT(decimal(18, 3), Utilized_Gas_Produced) / CONVERT(decimal(18, 
                      3), Actual_Total_Gas_Produced) * 100 AS Percentage_Utilized
FROM         dbo.WP_GAS_PRODUCTION_ACTIVITIES AS a
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover]
AS
SELECT     a.OML_ID, a.OML_Name AS oml_name_VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT, a.CompanyName, a.Companyemail, a.Year_of_WP, 
                      a.Exploration_Actual, a.Development_Actual, a.Appraisal_Actual, a.Exploration_Proposed, a.Development_Proposed, a.Appraisal_Proposed, 
                      b.OML_Name AS oml_name_INITIAL_WELL_COMPLETION_JOBS, b.CompanyName AS Expr1, b.Companyemail AS Expr2, b.Year_of_WP AS Expr3, 
                      b.Current_year_Actual_Number, b.Proposed_year_data, c.OML_Name AS OML_name_WORKOVERS_RECOMPLETION_JOBS, c.CompanyName AS Expr4, 
                      c.Companyemail AS Expr5, c.Year_of_WP AS Expr6, c.Current_year_Actual_Number_data, c.Proposed_year_data AS Expr7
FROM         dbo.VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT AS a INNER JOIN
                      dbo.INITIAL_WELL_COMPLETION_JOBS AS b ON a.Companyemail = b.Companyemail AND a.OML_Name = b.OML_Name INNER JOIN
                      dbo.WORKOVERS_RECOMPLETION_JOBS AS c ON b.Companyemail = c.Companyemail AND b.OML_Name = c.OML_Name
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover_by_year_companyemail]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover_by_year_companyemail]
AS
SELECT     Companyemail, Year_of_WP, SUM(CAST(Exploration_Actual AS int)) AS Exploration_Actual, SUM(CAST(Development_Actual AS int)) AS Development_Actual, 
                      SUM(CAST(Appraisal_Actual AS int)) AS Appraisal_Actual, SUM(CAST(Exploration_Proposed AS int)) AS Exploration_Proposed, 
                      SUM(CAST(Development_Proposed AS int)) AS Development_Proposed, SUM(CAST(Appraisal_Proposed AS int)) AS Appraisal_Proposed, 
                      SUM(CAST(Current_year_Actual_Number AS int)) AS Current_year_Actual_Number_well_completion, SUM(CAST(Proposed_year_data AS int)) 
                      AS Proposed_year_data_well_completion, SUM(CAST(Current_year_Actual_Number_data AS int)) AS Current_year_Actual_Number_data_workover, 
                      SUM(CAST(Expr7 AS int)) AS Expr7_Proposed_workover
FROM         dbo.VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover
GROUP BY Companyemail, Year_of_WP
GO
/****** Object:  View [dbo].[VW_SEISMIC_DATA_QUANTUM]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_SEISMIC_DATA_QUANTUM]
AS
SELECT     a.OML_Name, a.CompanyName, a.Companyemail, a.Year, a.Geological_location, b.Geo_type_of_data_acquired, b.Quantum, b.OML_Name AS OML_Name_, 
                      b.Companyemail AS companyemail_, b.Year_of_WP
FROM         dbo.CONCESSION_SITUATION AS a INNER JOIN
                      dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS b ON a.OML_Name = b.OML_Name AND a.Companyemail = b.Companyemail AND a.Year = b.Year_of_WP
GO
/****** Object:  View [dbo].[VW_SEISMIC_DATA_QUANTUM_SUM_BY_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_SEISMIC_DATA_QUANTUM_SUM_BY_YEAR]
AS
SELECT     Year, SUM(CAST(Quantum AS int)) AS Quantum
FROM         dbo.VW_SEISMIC_DATA_QUANTUM
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_OML_Senior_Staff_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Senior_Staff_INDEX_WEIGHTED_SCORE]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Senior Staff' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 

                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT

											  ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
											   
											   -- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
											   ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(total_no_of_senior_staff AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
																			
																			-- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
																			ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                                                                                    FROM          (  
                                                                                                    

																									SELECT  CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_senior_staff AS NUMERIC(20,2) )) AS Produced , Consession_Type
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                      WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                                            
                                                                                                                            )AS a_1   ) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Senior Staff')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover_by_year]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover_by_year]
AS
SELECT     Year_of_WP, SUM(CAST(Exploration_Actual AS int)) AS Exploration_Actual, SUM(CAST(Development_Actual AS int)) AS Development_Actual, 
                      SUM(CAST(Appraisal_Actual AS int)) AS Appraisal_Actual, SUM(CAST(Exploration_Proposed AS int)) AS Exploration_Proposed, 
                      SUM(CAST(Development_Proposed AS int)) AS Development_Proposed, SUM(CAST(Appraisal_Proposed AS int)) AS Appraisal_Proposed, 
                      SUM(CAST(Current_year_Actual_Number AS int)) AS Current_year_Actual_Number_well_completion, SUM(CAST(Proposed_year_data AS int)) 
                      AS Proposed_year_data_well_completion, SUM(CAST(Current_year_Actual_Number_data AS int)) AS Current_year_Actual_Number_data_workover, 
                      SUM(CAST(Expr7 AS int)) AS Expr7_Proposed_workover
FROM         dbo.VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_tobe_pivoted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_tobe_pivoted]
AS
SELECT     Contract_Type, SUM(CAST(Current_Actual_Year AS decimal)) AS Annual_Total_Production_by_CONTRACT_TYPE, Year_of_WP
FROM         dbo.GAS_PRODUCTION_ACTIVITIES
GROUP BY Contract_Type, Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_pivoted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_pivoted]
AS

  -- Pivot table with one row and five columns  
SELECT Contract_Type AS Contract_Type,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT Contract_Type , Year_of_WP, Annual_Total_Production_by_CONTRACT_TYPE   
    FROM WP_GAS_PRODUCTION_ACTIVITIES_contract_type_tobe_pivoted) AS SourceTable  
PIVOT  
(  
SUM(Annual_Total_Production_by_CONTRACT_TYPE)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[WP_OML_GAS_Utilisation_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_GAS_Utilisation_INDEX_WEIGHTED_SCORE_OLD]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Gas Utilisation' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS int)) AS Utilized, SUM(CAST(Current_Actual_Year AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                                                    FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(Current_Actual_Year AS int)) AS Produced
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                                            WHERE      (Consession_Type = 'OML')
                                                                                                                            GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_GAS_Utilisation_INDEX_MN_MAX_RGT_by_YEAR) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Gas Utilisation')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OML_Top_Management_Staff_INDEX_WEIGHTED_SCORE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_Top_Management_Staff_INDEX_WEIGHTED_SCORE]
AS



SELECT     H.CompanyName, H.Utilized, H.Produced, H.Unscaled_Score, H.Unscaled_Score_sum, H.Scaled_by_Reciprocal_GrandTotal_RGT, 
                      H.Year_of_WP, H.MAX_RGT, H.MIN_RGT, H.Recalibrated_Scaled_Index, I.INDEX_TYPE, I.Weight, H.Recalibrated_Scaled_Index * I.Weight AS Weighted_Score, 
                      H.Consession_Type
FROM         (SELECT     E.CompanyName, E.Utilized, E.Produced, E.Unscaled_Score, E.Unscaled_Score_sum, E.Scaled_by_Reciprocal_GrandTotal_RGT,
 
         F.Year_of_WP, F.MAX_RGT, F.MIN_RGT, F.MIN_RGT + ISNULL((E.Scaled_by_Reciprocal_GrandTotal_RGT - F.MIN_RGT) / NULLIF ((F.MAX_RGT - F.MIN_RGT) * (100 - 0), 0),0) AS Recalibrated_Scaled_Index, 'Top Management' AS INDEX_TYPE, 'OML' AS Consession_Type
                     
                     
                       FROM          (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                            --  b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
											 ISNULL( b.Unscaled_Score / NULLIF(d.Unscaled_Score_sum, 0), 0)  * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                                               FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced,
											   
											   -- Utilized / CONVERT(decimal(18, 1), Produced)  * 100 AS Unscaled_Score
											   ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score

                                                                       FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS NUMERIC(20,2) )) AS Utilized, SUM(CAST(total_no_of_top_management_staff AS NUMERIC(20,2) )) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                                               GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                                          (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, 
																			-- Utilized / CONVERT(decimal(18, 1), Produced) * 100 AS Unscaled_Score
																			ISNULL( Utilized / NULLIF(Produced, 0), 0)  * 100 AS Unscaled_Score
                                                                                                    FROM          (
                                                                                                    
                                                                                                    SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS NUMERIC(20,2) )) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_top_management_staff AS NUMERIC(20,2) )) AS Produced , Consession_Type
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                         WHERE      Consession_Type = 'OML'
                                                                                                                         GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                                            
                                                                                                                            
                                                                                                                            
                                                                                                                            )AS a_1) AS c
                                                                            GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS E INNER JOIN
                                                  (SELECT     Year_of_WP, MAX_RGT, MIN_RGT
                                                    FROM          dbo.WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR ) AS F ON E.Year_of_WP = F.Year_of_WP) AS H INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Top Management')) AS I ON H.INDEX_TYPE = I.INDEX_TYPE
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover _join_Contracttype]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover _join_Contracttype]
AS
SELECT DISTINCT 
                      a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.oml_name_VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT, b.CompanyName AS Expr8, 
                      b.Companyemail, b.Year_of_WP, b.Exploration_Actual, b.Development_Actual, b.Appraisal_Actual, b.Exploration_Proposed, b.Development_Proposed, 
                      b.Appraisal_Proposed, b.oml_name_INITIAL_WELL_COMPLETION_JOBS, b.Expr1, b.Expr2, b.Expr3, b.Current_year_Actual_Number, b.Proposed_year_data, 
                      b.OML_name_WORKOVERS_RECOMPLETION_JOBS, b.Expr4, b.Expr5, b.Expr6, b.Current_year_Actual_Number_data, b.Expr7
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                      dbo.VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover AS b ON a.COMPANY_EMAIL = b.Companyemail
GO
/****** Object:  View [dbo].[VW_GAS_PRODUCTION_ACTIVITIES]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_GAS_PRODUCTION_ACTIVITIES]
AS
SELECT DISTINCT a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.Year_of_WP, b.Current_Actual_Year, b.Utilized, b.Flared, b.Forecast_, b.Companyemail
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                      dbo.GAS_PRODUCTION_ACTIVITIES AS b ON a.COMPANY_EMAIL = b.Companyemail
GO
/****** Object:  View [dbo].[VW_GAS_PRODUCTION_ACTIVITIES_total]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_GAS_PRODUCTION_ACTIVITIES_total]
AS
SELECT     Contract_Type, SUM(CAST(Current_Actual_Year AS int)) AS Current_Actual_Year, SUM(CAST(Utilized AS int)) AS Utilized, SUM(CAST(Flared AS int)) AS Flared, 
                      SUM(CAST(Forecast_ AS int)) AS Forecast_, Year_of_WP
FROM         dbo.VW_GAS_PRODUCTION_ACTIVITIES
GROUP BY Contract_Type, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_TOBE_Pivotted_by_company_productionmonth_year_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_TOBE_Pivotted_by_company_productionmonth_year_PLANNED]
AS

SELECT     CompanyName, Production_month, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company_name, Year_of_WP
FROM   dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED
				 
				 
GROUP BY CompanyName, Production_month, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_Pivotted_by_company_productionmonth_year_breakdown_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_Pivotted_by_company_productionmonth_year_breakdown_PLANNED]
AS

  -- Pivot table with one row and five columns  
SELECT CompanyName AS CompanyName, Year_of_WP  as Year_of_WP ,

January,February,March,April,May,June,July,August,September,October,November,December
  
FROM  
(SELECT CompanyName , Year_of_WP, Production_month ,Annual_Total_Production_by_company_name   
    FROM WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_TOBE_Pivotted_by_company_productionmonth_year_PLANNED) AS SourceTable  
PIVOT  
(  
SUM(Annual_Total_Production_by_company_name) 
FOR Production_month IN (January,February,March,April,May,June,July,August,September,October,November,December)  
) AS PivotTable;
GO
/****** Object:  View [dbo].[VW_GAS_PRODUCTION_ACTIVITIES_total_summed]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_GAS_PRODUCTION_ACTIVITIES_total_summed]
AS
SELECT     Year_of_WP, SUM(Current_Actual_Year) AS Current_Actual_Year, SUM(Utilized) AS Utilized, SUM(Flared) AS Flared, SUM(Forecast_) AS Forecast_
FROM         dbo.VW_GAS_PRODUCTION_ACTIVITIES_total
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_TOBE_Pivotted_by_company_productionmonth_year]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_TOBE_Pivotted_by_company_productionmonth_year]
AS
SELECT     CompanyName, Production_month, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company_name, Year_of_WP
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
GROUP BY CompanyName, Production_month, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_Pivotted_by_company_productionmonth_year_breakdown]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_Pivotted_by_company_productionmonth_year_breakdown]
AS

  -- Pivot table with one row and five columns  
SELECT CompanyName AS CompanyName, Year_of_WP  as Year_of_WP ,

January,February,March,April,May,June,July,August,September,October,November,December
  
FROM  
(SELECT CompanyName , Year_of_WP, Production_month ,Annual_Total_Production_by_company_name   
    FROM WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_TOBE_Pivotted_by_company_productionmonth_year) AS SourceTable  
PIVOT  
(  
SUM(Annual_Total_Production_by_company_name) 
FOR Production_month IN (January,February,March,April,May,June,July,August,September,October,November,December)  
) AS PivotTable;
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_tobe_Pivoted_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_tobe_Pivoted_PLANNED]
AS

SELECT     TOP (100) PERCENT Terrain, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, Year_of_WP
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED
GROUP BY Terrain, Year_of_WP
ORDER BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_Terrain_Pivoted_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_Terrain_Pivoted_PLANNED]
AS


  -- Pivot table with one row and five columns  
SELECT Terrain AS Terrain,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT Terrain , Year_of_WP, Annual_Total_Production_by_company   
    FROM WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_tobe_Pivoted_PLANNED) AS SourceTable  
	       
PIVOT  
(  
SUM(Annual_Total_Production_by_company)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover_by_year_contract_type]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover_by_year_contract_type]
AS
SELECT     Contract_Type, Year_of_WP, SUM(CAST(Exploration_Actual AS int)) AS Exploration_Actual, SUM(CAST(Development_Actual AS int)) AS Development_Actual, 
                      SUM(CAST(Appraisal_Actual AS int)) AS Appraisal_Actual, SUM(CAST(Exploration_Proposed AS int)) AS Exploration_Proposed, 
                      SUM(CAST(Development_Proposed AS int)) AS Development_Proposed, SUM(CAST(Appraisal_Proposed AS int)) AS Appraisal_Proposed, 
                      SUM(CAST(Current_year_Actual_Number AS int)) AS Current_year_Actual_Number_INITIAL_WELL_COMPLETION_JOBS, SUM(CAST(Proposed_year_data AS int)) 
                      AS Proposed_year_data_INITIAL_WELL_COMPLETION_JOBS, SUM(CAST(Current_year_Actual_Number_data AS int)) 
                      AS Current_year_Actual_Number_data_WORKOVERS_RECOMPLETION_JOBS, SUM(CAST(Expr7 AS int)) AS Proposed_WORKOVERS_RECOMPLETION_JOBS
FROM         dbo.[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_PIVOT_Completion_Workover _join_Contracttype]
GROUP BY Contract_Type, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_DISCOVERY_INDEX_WEIGHTED_SCORE_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_DISCOVERY_INDEX_WEIGHTED_SCORE_OLD]
AS


SELECT     I.CompanyName, I.Year_of_WP, I.Consession_Type, I.Unscaled_Score, I.Unscaled_Score_sum, I.Scaled_by_Reciprocal_GrandTotal_RGT, I.MAX_RGT, I.MIN_RGT, 
                      I.Recalibrated_Scaled_Index, J.Weight, I.Recalibrated_Scaled_Index * J.Weight AS Weighted_Score, I.INDEX_TYPE
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, Unscaled_Score, Unscaled_Score_sum, Scaled_by_Reciprocal_GrandTotal_RGT, MAX_RGT, MIN_RGT, 
                                              MIN_RGT + ISNULL((Scaled_by_Reciprocal_GrandTotal_RGT - MIN_RGT) / NULLIF ((MAX_RGT - MIN_RGT) * (100 - 0), 0), 0) AS Recalibrated_Scaled_Index, 
                                              'Discovery Index' AS INDEX_TYPE
                       FROM          (SELECT     F.CompanyName, F.Year_of_WP, F.Consession_Type, F.Unscaled_Score, F.Unscaled_Score_sum, F.Scaled_by_Reciprocal_GrandTotal_RGT, 
                                                                      G.MAX_RGT, G.MIN_RGT
                                               FROM          (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                                                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) 
                                                                                              AS Scaled_by_Reciprocal_GrandTotal_RGT
                                                                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                       FROM          dbo.DRILLING_OPERATIONS_
                                                                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                                                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                                                                            CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                                                                    FROM          dbo.DRILLING_OPERATIONS_ AS DRILLING_OPERATIONS_1
                                                                                                                                                    WHERE      (Consession_Type = 'OML')) AS A
                                                                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F INNER JOIN
                                                                      dbo.WP_OML_Discovery_Index_MN_MAX_RGT_by_YEAR AS G ON F.Year_of_WP = G.Year_of_WP) AS H) AS I INNER JOIN
                          (SELECT     INDEX_TYPE, Weight, CONCESSIONTYPE
                            FROM          dbo.ADMIN_PERFOMANCE_INDEX
                            WHERE      (CONCESSIONTYPE = 'OML') AND (INDEX_TYPE = 'Discovery Index')) AS J ON I.INDEX_TYPE = J.INDEX_TYPE
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_tobe_Pivoted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_tobe_Pivoted]
AS
SELECT     TOP (100) PERCENT Terrain, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, Year_of_WP
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
GROUP BY Terrain, Year_of_WP
ORDER BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_Terrain_Pivoted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_Terrain_Pivoted]
AS

  -- Pivot table with one row and five columns  
SELECT Terrain AS Terrain,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT Terrain , Year_of_WP, Annual_Total_Production_by_company   
    FROM WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_tobe_Pivoted) AS SourceTable  
PIVOT  
(  
SUM(Annual_Total_Production_by_company)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_ContractType_tobe_pivoted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_ContractType_tobe_pivoted]
AS
SELECT     Contract_Type, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_CONTRACT_TYPE, Year_of_WP
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
GROUP BY Contract_Type, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_ContractType_Pivotted]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_ContractType_Pivotted]
AS

  -- Pivot table with one row and five columns  
SELECT Contract_Type AS Contract_Type,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT Contract_Type , Year_of_WP, Annual_Total_Production_by_CONTRACT_TYPE   
    FROM WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_by_ContractType_tobe_pivoted) AS SourceTable  
PIVOT  
(  
SUM(Annual_Total_Production_by_CONTRACT_TYPE)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[ADMIN_COMPANYEMAIL_REMINDER_TABLE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[ADMIN_COMPANYEMAIL_REMINDER_TABLE]
AS
SELECT        dbo.ADMIN_COMPANY_INFORMATION.Id, dbo.ADMIN_COMPANY_INFORMATION.COMPANY_NAME, dbo.ADMIN_COMPANY_INFORMATION.EMAIL, dbo.ADMIN_COMPANY_INFORMATION.COMPANY_ID, 
                         dbo.ADMIN_CONCESSIONS_INFORMATION.OPEN_DATE, dbo.ADMIN_CONCESSIONS_INFORMATION.CLOSE_DATE, dbo.ADMIN_CONCESSIONS_INFORMATION.EMAIL_REMARK, 
                         dbo.ADMIN_CONCESSIONS_INFORMATION.Company_ID AS Expr1
FROM            dbo.ADMIN_COMPANY_INFORMATION INNER JOIN
                         dbo.ADMIN_CONCESSIONS_INFORMATION ON dbo.ADMIN_COMPANY_INFORMATION.COMPANY_ID = dbo.ADMIN_CONCESSIONS_INFORMATION.Company_ID
GO
/****** Object:  View [dbo].[Sum_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[Sum_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS]
AS
SELECT DISTINCT 
                      CompanyName, OML_Name, well_name, spud_date, Year_of_WP, Category, well_cost, Number_of_Days_to_Total_Depth, Well_Status_and_Depth, Contract_Type, 
                      Terrain
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
GO
/****** Object:  View [dbo].[Sum_GEOPHYSICAL_ACTIVITIES_ACQUISITION]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[Sum_GEOPHYSICAL_ACTIVITIES_ACQUISITION]
AS
SELECT     CompanyName, OML_Name, Terrain, Name_of_Contractor, SUM(CAST(Quantum_Approved AS float)) AS Quantum_Approved, SUM(CAST(Quantum AS float)) 
                      AS Quantum, Year_of_WP, Geo_type_of_data_acquired
FROM         dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
GROUP BY Year_of_WP, Geo_type_of_data_acquired, CompanyName, OML_Name, Terrain, Name_of_Contractor

GO
/****** Object:  View [dbo].[Sum_GEOPHYSICAL_ACTIVITIES_PROCESSING]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[Sum_GEOPHYSICAL_ACTIVITIES_PROCESSING]
AS
SELECT     CompanyName, OML_Name, Terrain, Name_of_Contractor, SUM(CAST(Quantum_Approved AS float)) AS Quantum_Approved, 
                      SUM(CAST(Geo_Quantum_of_Data AS float)) AS Quantum_Processed, Year_of_WP, Geo_Type_of_Data_being_Processed
FROM         dbo.GEOPHYSICAL_ACTIVITIES_PROCESSING
GROUP BY Year_of_WP, Geo_Type_of_Data_being_Processed, CompanyName, OML_Name, Terrain, Name_of_Contractor

GO
/****** Object:  View [dbo].[View_2]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[View_2]
AS
SELECT     name, SUM(age) AS age
FROM         dbo.Table_1
GROUP BY name
GO
/****** Object:  View [dbo].[VW_company_and_contract_type]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_company_and_contract_type]
AS
SELECT DISTINCT CompanyName, Contract_Type
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_appraisal]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_appraisal]
AS
SELECT     TOP (1000) Id, OML_ID, OML_Name, CompanyName, Companyemail, Year_of_WP, Category, Actual_No_Drilled_in_Current_Year, Proposed_No_Drilled, 
                      Processing_Fees_Paid, Comments, No_of_wells_cored, Actual_year, proposed_year, Created_by, Updated_by, Date_Created, Date_Updated
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
WHERE     (Category = 'Appraisal')
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_development]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_development]
AS
SELECT     TOP (1000) Id, OML_ID, OML_Name, CompanyName, Companyemail, Year_of_WP, Category, Actual_No_Drilled_in_Current_Year, Proposed_No_Drilled, 
                      Processing_Fees_Paid, Comments, No_of_wells_cored, Actual_year, proposed_year, Created_by, Updated_by, Date_Created, Date_Updated
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
WHERE     (Category = 'Development')
GO
/****** Object:  View [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_exploration]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[VW_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_exploration]
AS
SELECT     TOP (1000) Id, OML_ID, OML_Name, CompanyName, Companyemail, Year_of_WP, Category, Actual_No_Drilled_in_Current_Year, Proposed_No_Drilled, 
                      Processing_Fees_Paid, Comments, No_of_wells_cored, Actual_year, proposed_year, Created_by, Updated_by, Date_Created, Date_Updated
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
WHERE     (Category = 'Exploration')
GO
/****** Object:  View [dbo].[VW_Geophysical_SEISMIC_DATA_old]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_Geophysical_SEISMIC_DATA_old]
AS
SELECT DISTINCT 
                      a.CompanyName, a.Contract_Type, a.COMPANY_EMAIL, b.Actual_year_aquired_data AS Actual_year_aquired_data_ACQUISITION, 
                      b.proposed_year_data AS proposed_year_data_ACQUISITION, b.CompanyName AS companyname_ACQUISITION, b.Companyemail AS companyemail_ACQUISITION, 
                      b.Year_of_WP AS Year_ACQUISITION, c.Actual_year_aquired_data AS Actual_year_aquired_data_PROCESSING, 
                      c.proposed_year_data AS proposed_year_data_PROCESSING, c.CompanyName AS companyname_PROCESSING, c.Companyemail AS companyemail_PROCESSING, 
                      c.Year_of_WP AS Year_PROCESSING
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION AS a INNER JOIN
                      dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS b ON a.COMPANY_EMAIL = b.Companyemail INNER JOIN
                      dbo.GEOPHYSICAL_ACTIVITIES_PROCESSING AS c ON a.COMPANY_EMAIL = c.Companyemail
GO
/****** Object:  View [dbo].[WP_Cost_Efficiency_Metric_CAPEX_OPEX_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_Cost_Efficiency_Metric_CAPEX_OPEX_OLD]
AS
SELECT     CompanyName, Year_of_WP, SUM(CAST(naira AS int)) AS naira
FROM         dbo.BUDGET_CAPEX_OPEX
GROUP BY CompanyName, Year_of_WP
GO
/****** Object:  View [dbo].[WP_Cost_Efficiency_Metric_NET_PRODUCTION_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_Cost_Efficiency_Metric_NET_PRODUCTION_OLD]
AS
SELECT     CompanyName, Year_of_WP, SUM(CAST(Production AS int)) AS Production
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
WHERE     (Consession_Type = 'OML')
GROUP BY CompanyName, Year_of_WP
GO
/****** Object:  View [dbo].[WP_COUNT_ADMIN_DATETIME_PRESENTATION_BY_TOTAL_COUNT_YEARLY]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_ADMIN_DATETIME_PRESENTATION_BY_TOTAL_COUNT_YEARLY]
AS
SELECT COUNT(YEAR) AS TOTAL_COUNT_YEARLY , YEAR
FROM         dbo.ADMIN_DATETIME_PRESENTATION
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_COUNT_ADMIN_DATETIME_PRESENTATION_BY_YEAR_PRESENTED_CATEGORY]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_ADMIN_DATETIME_PRESENTATION_BY_YEAR_PRESENTED_CATEGORY]
AS
SELECT COUNT(PRESENTED) AS count, Year ,PRESENTED
FROM         dbo.ADMIN_DATETIME_PRESENTATION
GROUP BY Year , PRESENTED
GO
/****** Object:  View [dbo].[WP_COUNT_ADMIN_DATETIME_PRESENTATION_BY_YEAR_PRESENTED_COMPANYNAME]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_ADMIN_DATETIME_PRESENTATION_BY_YEAR_PRESENTED_COMPANYNAME]
AS
SELECT COUNT(PRESENTED) AS count, Year, CompanyName ,PRESENTED
FROM         dbo.ADMIN_DATETIME_PRESENTATION
GROUP BY Year, CompanyName , PRESENTED
GO
/****** Object:  View [dbo].[WP_COUNT_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS]
AS
SELECT     COUNT(Category) AS COUNT, Category, Year_of_WP
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
GROUP BY Year_of_WP, Category
GO
/****** Object:  View [dbo].[WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR_old]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_COUNT_PRESENTATION_CATERGORY_BY_YEAR_old]
AS
SELECT     TOP (100) PERCENT COUNT(Status_) AS count, Year, Status_
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION
WHERE     (Status_ IN ('presented', 'Failed to show up', 'Update Required', 'Showed up but could not present', 'Not invited'))
GROUP BY Year, Status_
ORDER BY Year
GO
/****** Object:  View [dbo].[WP_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_DRILLING_OPERATIONS_CATEGORIES_OF_WELLS]
AS
SELECT     TOP (100) PERCENT SUM(CAST(Actual_No_Drilled_in_Current_Year AS decimal)) AS Actual_No_Drilled_in_Current_Year, SUM(CAST(Proposed_No_Drilled AS decimal)) 
                      AS Proposed_No_Drilled, Year_of_WP, Category
FROM         dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
WHERE     (Category IN ('Exploration', 'Appraisal', 'Development', '1st Appraisal', '2nd Appraisal', 'Ordinary Appraisal '))
GROUP BY Year_of_WP, Category
ORDER BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_Contract_Type]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_Contract_Type]
AS
SELECT     Year_of_WP, Contract_Type, SUM(CAST(Current_Actual_Year AS decimal)) AS Actual_Total_Gas_Produced, SUM(CAST(Utilized AS decimal)) AS Utilized_Gas_Produced, 
                      SUM(CAST(Flared AS decimal)) AS Flared_Gas_Produced
FROM         dbo.GAS_PRODUCTION_ACTIVITIES
GROUP BY Year_of_WP, Contract_Type
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_basis]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_basis]
AS
SELECT DISTINCT 
                      a.Contract_Type, a.Total_GAS_Production_by_company, a.Year_of_WP, b.Total_GAS_Production_by_year, CONVERT(decimal(18, 2), 
                      a.Total_GAS_Production_by_company) / b.Total_GAS_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     Contract_Type, SUM(CAST(Current_Actual_Year AS decimal)) AS Total_GAS_Production_by_company, Year_of_WP
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY Contract_Type, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Current_Actual_Year AS decimal)) AS Total_GAS_Production_by_year, Year_of_WP
                            FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_basis_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_contract_type_basis_PLANNED]
AS


SELECT DISTINCT 
                      a.Contract_Type, a.Total_GAS_Production_by_company, a.Year_of_WP, b.Total_GAS_Production_by_year, CONVERT(decimal(18, 2), 
                      a.Total_GAS_Production_by_company) / b.Total_GAS_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     Contract_Type, SUM(CAST(proposed_utilization AS int)) AS Total_GAS_Production_by_company, Year_of_WP
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY Contract_Type, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(proposed_production AS int)) AS Total_GAS_Production_by_year, Year_of_WP
                            FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_penalty_payment]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_penalty_payment]
AS
SELECT     CompanyName, Year_of_WP, SUM(CAST(Flared AS decimal)) AS Flared, SUM(CAST(penaltyfeepaid AS decimal)) AS penaltyfeepaid, SUM(CAST(Amount_Paid AS decimal)) 
                      AS Amount_Paid
FROM         dbo.GAS_PRODUCTION_ACTIVITIES
GROUP BY CompanyName, Year_of_WP
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  *****
CONVERT(decimal(18, 2), a.Annual_Total_Production_by_company) 
                    / b.Annual_Total_Production_by_year * 100 AS Percentage_Production*/
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared]
AS
SELECT     CompanyName, Year_of_WP, Current_Actual_Year, Utilized, Flared, CONVERT(decimal(18, 2), Flared) / NULLIF(Current_Actual_Year, 0)  * 100 AS Percentage_FLARED
FROM         (SELECT     CompanyName, Year_of_WP, SUM(CAST(Current_Actual_Year AS decimal)) AS Current_Actual_Year, SUM(CAST(Utilized AS decimal)) AS Utilized, 
                                              SUM(CAST(Flared AS decimal)) AS Flared
                       FROM  dbo.GAS_PRODUCTION_ACTIVITIES where ISNUMERIC(Utilized) = 1
                       GROUP BY CompanyName, Year_of_WP) AS SUB
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared_PERCENTAGE]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared_PERCENTAGE]
AS

SELECT      Year_of_WP, Current_Actual_Year, Utilized, Flared, CONVERT(decimal(18, 2), Flared) / Current_Actual_Year * 100 AS Percentage , 'FLARED' TYPE_
FROM         (SELECT      Year_of_WP, SUM(CAST(Current_Actual_Year AS int)) AS Current_Actual_Year, SUM(CAST(Utilized AS int)) AS Utilized, 
                                              SUM(CAST(Flared AS int)) AS Flared
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY Year_of_WP) AS SUB
                       
                       union all
                       
                       
SELECT      Year_of_WP, Current_Actual_Year, Utilized, Flared, CONVERT(decimal(18, 2), Utilized) / Current_Actual_Year * 100 AS Percentage , 'UTILIZED' TYPE_
FROM         (SELECT     Year_of_WP, SUM(CAST(Current_Actual_Year AS int)) AS Current_Actual_Year, SUM(CAST(Utilized AS int)) AS Utilized, 
                                              SUM(CAST(Flared AS int)) AS Flared
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY  Year_of_WP) AS SUB
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared_PERCENTAGE_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared_PERCENTAGE_PLANNED]
AS

SELECT      Year_of_WP, Current_Actual_Year, Utilized, Flared, CONVERT(decimal(18, 2), Flared) / Current_Actual_Year * 100 AS Percentage , 'FLARED' TYPE_
FROM         (SELECT      Year_of_WP, SUM(CAST(proposed_production AS int)) AS Current_Actual_Year, SUM(CAST(proposed_utilization AS int)) AS Utilized, 
                                              SUM(CAST(proposed_flaring AS int)) AS Flared
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY Year_of_WP) AS SUB
                       
                       union all
                       
                       
SELECT      Year_of_WP, Current_Actual_Year, Utilized, Flared, CONVERT(decimal(18, 2), Utilized) / Current_Actual_Year * 100 AS Percentage , 'UTILIZED' TYPE_
FROM         (SELECT     Year_of_WP, SUM(CAST(proposed_production AS int)) AS Current_Actual_Year, SUM(CAST(proposed_utilization AS int)) AS Utilized, 
                                              SUM(CAST(proposed_flaring AS int)) AS Flared
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY  Year_of_WP) AS SUB
GO
/****** Object:  View [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  *****
CONVERT(decimal(18, 2), a.Annual_Total_Production_by_company) 
                    / b.Annual_Total_Production_by_year * 100 AS Percentage_Production*/
CREATE VIEW [dbo].[WP_GAS_PRODUCTION_ACTIVITIES_produced_utilized_flared_PLANNED]
AS

SELECT     CompanyName, Year_of_WP, Current_Actual_Year, Utilized, Flared, ISNULL(CONVERT(decimal(18, 2), Flared) / Current_Actual_Year * 100,0) AS Percentage_FLARED
FROM         (SELECT     CompanyName, Year_of_WP, SUM(CAST(proposed_production AS int)) AS Current_Actual_Year, SUM(CAST(proposed_utilization AS int)) AS Utilized, 
                                              SUM(CAST(proposed_flaring AS int)) AS Flared
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY CompanyName, Year_of_WP) AS SUB
GO
/****** Object:  View [dbo].[WP_Gas_Production_Utilisation_And_Flaring_Forecast]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_Gas_Production_Utilisation_And_Flaring_Forecast]
AS
SELECT     Year_of_WP, Current_Actual_Year, Utilized, Flared, CONVERT(decimal(18, 2), Flared) / Current_Actual_Year * 100 AS Percentage_flared, CONVERT(decimal(18, 2), 
                      Utilized) / Current_Actual_Year * 100 AS Percentage_Utilized
FROM         (SELECT     Year_of_WP, SUM(CAST(proposed_production AS int)) AS Current_Actual_Year, SUM(CAST(proposed_utilization AS int)) AS Utilized, 
                                              SUM(CAST(proposed_flaring AS int)) AS Flared
                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                       GROUP BY Year_of_WP) AS SUB
GO
/****** Object:  View [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_GEOPHYSICAL_ACTIVITIES_ACQUISITION]
AS
SELECT     Geo_type_of_data_acquired, SUM(CAST(Actual_year_aquired_data AS decimal)) AS Actual_year_aquired_data, SUM(CAST(proposed_year_data AS decimal)) 
                      AS proposed_year_data, Year_of_WP
FROM         dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
GROUP BY Geo_type_of_data_acquired, Year_of_WP
GO
/****** Object:  View [dbo].[WP_GEOPHYSICAL_ACTIVITIES_PROCESSING]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_GEOPHYSICAL_ACTIVITIES_PROCESSING]
AS

SELECT     Geo_Type_of_Data_being_Processed, Year_of_WP, SUM(CAST(Processed_Actual AS decimal(18,2))) AS Processed_Actual, SUM(CAST(Processed_Proposed AS decimal(18,2))) 
                      AS Processed_Proposed, SUM(CAST(Reprocessed_Actual AS decimal(18,2))) AS Reprocessed_Actual, SUM(CAST(Reprocessed_Proposed AS decimal(18,2))) AS Reprocessed_Proposed, 
                      SUM(CAST(Interpreted_Actual AS decimal(18,2))) AS Interpreted_Actual, SUM(CAST(Interpreted_Proposed AS decimal(18,2))) AS Interpreted_Proposed
FROM         dbo.GEOPHYSICAL_ACTIVITIES_PROCESSING
GROUP BY Geo_Type_of_Data_being_Processed, Year_of_WP


GO
/****** Object:  View [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_by_consequences]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_by_consequences]
AS
SELECT     TOP (100) PERCENT SUM(CAST(Frequency AS int)) AS sum_accident, Year_of_WP, Consequence
FROM         dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
WHERE     (Cause IN ('EQUIPMENT FAILURE', 'HUMAN ERROR', 'MYSTERY SPILLS', 'SABOTAGE'))
GROUP BY Year_of_WP, Consequence
ORDER BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_total_accident]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_total_accident]
AS
SELECT     TOP (100) PERCENT SUM(CAST(Frequency AS int)) AS Sum_accident, Year_of_WP
FROM         dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW
GROUP BY Year_of_WP
ORDER BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_HSE_FATALITIES_accident_statistic_table]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_HSE_FATALITIES_accident_statistic_table]
AS
SELECT     CompanyName, Year_of_WP, Fatalities_Type, SUM(CAST(Fatalities_Proposed_year AS int)) AS Fatalities_Proposed_year, SUM(CAST(Fatalities_Current_year AS int)) 
                      AS Fatalities_Current_year, type_of_incidence
FROM         dbo.HSE_FATALITIES
GROUP BY CompanyName, Year_of_WP, type_of_incidence, Fatalities_Type
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_Contract_Type]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_Contract_Type]
AS
SELECT     Year_of_WP, SUM(CAST(Total_Reconciled_National_Crude_Oil_Production AS decimal)) AS Total_Reconciled_National_Crude_Oil_Production, Contract_Type
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES
GROUP BY Year_of_WP, Contract_Type
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_By_month_year]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_By_month_year]
AS
SELECT     TOP (100) PERCENT Production_month_id, Production_month, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, SUM(CONVERT(decimal(18, 2), 
                      Avg_Daily_Production)) / COUNT(Avg_Daily_Production) AS Annual_Avg_Daily_Production, Year_of_WP
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
GROUP BY Production_month, Production_month_id, Year_of_WP
ORDER BY Production_month_id
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_By_month_year_PROPOSED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_By_month_year_PROPOSED]
AS


SELECT     TOP (100) PERCENT Production_month_id, Production_month, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, SUM(CONVERT(decimal(18, 2), 
                      Avg_Daily_Production)) / COUNT(Avg_Daily_Production) AS Annual_Avg_Daily_Production, Year_of_WP
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED
GROUP BY Production_month, Production_month_id, Year_of_WP
ORDER BY Production_month_id
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_Five_Year_Trend_for_Companies_Reserve_Replacement_Ratio]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_Five_Year_Trend_for_Companies_Reserve_Replacement_Ratio]
AS

  
  -- Pivot table with one row and five columns  
SELECT CompanyName AS CompanyName,   
[2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030]
  
FROM  
(SELECT CompanyName , Year_of_WP, SUM(CAST(Production AS int)) AS Production   
    FROM OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities group by CompanyName , Year_of_WP) AS SourceTable  
PIVOT  
(  
SUM(Production)  
FOR Year_of_WP IN ([2010],[2011],[2012],[2013],[2014],[2015],[2016],[2017],[2018],[2019],[2020],[2021],[2022],[2023],[2024],[2025],[2026],[2027],[2028],[2029],[2030])  
) AS PivotTable;
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION]
AS
SELECT DISTINCT 
                      a.CompanyName, a.Contract_Type, a.Terrain, a.Annual_Total_Production_by_company, a.Annual_Avg_Daily_Production, a.Year_of_WP, 
                      b.Annual_Total_Production_by_year, CONVERT(decimal(18, 2), a.Annual_Total_Production_by_company) 
                      / b.Annual_Total_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     CompanyName, Contract_Type, Terrain, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, SUM(CONVERT(decimal(18, 2), 
                                              Avg_Daily_Production)) / COUNT(Avg_Daily_Production) AS Annual_Avg_Daily_Production, Year_of_WP
                       FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
                       GROUP BY CompanyName, Contract_Type, Terrain, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Production AS int)) AS Annual_Total_Production_by_year, Year_of_WP
                            FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_by_Terrain]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_by_Terrain]
AS
SELECT DISTINCT 
                      a.Terrain, a.Annual_Total_Production_by_company, a.Year_of_WP, b.Annual_Total_Production_by_year, CONVERT(decimal(18, 2), 
                      a.Annual_Total_Production_by_company) / b.Annual_Total_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     Terrain, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, Year_of_WP
                       FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities
                       GROUP BY Terrain, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Production AS int)) AS Annual_Total_Production_by_year, Year_of_WP
                            FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_by_Terrain_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_by_Terrain_PLANNED]
AS

SELECT DISTINCT 
                      a.Terrain, a.Annual_Total_Production_by_company, a.Year_of_WP, b.Annual_Total_Production_by_year, CONVERT(decimal(18, 2), 
                      a.Annual_Total_Production_by_company) / b.Annual_Total_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     Terrain, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, Year_of_WP
                       FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED
                       GROUP BY Terrain, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Production AS int)) AS Annual_Total_Production_by_year, Year_of_WP
                            FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE_PROPOSED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_CONTRACT_TYPE_PROPOSED]
AS

SELECT DISTINCT 
                      a.Contract_Type, a.Annual_Total_Production_by_company, a.Year_of_WP, b.Annual_Total_Production_by_year, CONVERT(decimal(18, 2), 
                      a.Annual_Total_Production_by_company) / b.Annual_Total_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     Contract_Type, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, Year_of_WP
                       FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED
                       GROUP BY Contract_Type, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Production AS int)) AS Annual_Total_Production_by_year, Year_of_WP
                            FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_PROPOSED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_OIL_PRODUCTION_PROPOSED]
AS


SELECT DISTINCT 
                      a.CompanyName, a.Contract_Type, a.Terrain, a.Annual_Total_Production_by_company, a.Annual_Avg_Daily_Production, a.Year_of_WP, 
                      b.Annual_Total_Production_by_year, CONVERT(decimal(18, 2), a.Annual_Total_Production_by_company) 
                      / b.Annual_Total_Production_by_year * 100 AS Percentage_Production
FROM         (SELECT     CompanyName, Contract_Type, Terrain, SUM(CAST(Production AS int)) AS Annual_Total_Production_by_company, SUM(CONVERT(decimal(18, 2), 
                                              Avg_Daily_Production)) / COUNT(Avg_Daily_Production) AS Annual_Avg_Daily_Production, Year_of_WP
                       FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED
                       GROUP BY CompanyName, Contract_Type, Terrain, Year_of_WP) AS a INNER JOIN
                          (SELECT     SUM(CAST(Production AS int)) AS Annual_Total_Production_by_year, Year_of_WP
                            FROM          dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_PROPOSED AS OIL_CONDENSATE_PRODUCTION_ACTIVITIES_monthly_Activities_1
                            GROUP BY Year_of_WP) AS b ON a.Year_of_WP = b.Year_of_WP
GO
/****** Object:  View [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_Total_reconciled_crude_oil]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OIL_CONDENSATE_PRODUCTION_ACTIVITIES_Total_reconciled_crude_oil]
AS
SELECT     Year_of_WP, SUM(CAST(Total_Reconciled_National_Crude_Oil_Production AS decimal)) AS Total_Reconciled_National_Crude_Oil_Production
FROM         dbo.OIL_CONDENSATE_PRODUCTION_ACTIVITIES
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
			   
CREATE VIEW [dbo].[WP_OML_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS

SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), Quantum_Approved) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS int)) 
                                                                                              AS Quantum_Approved
                                                                       FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                       where  Quantum_Approved != 0
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM       (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Quantum_Approved),0),1) * 100 AS Unscaled_Score
                                                    
                                                  -- (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), Quantum_Approved) * 100 AS Unscaled_Score
                                                    
                                                    
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                           SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                    FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                    WHERE      (Consession_Type = 'OML') 
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Discovery_Index_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Discovery_Index_MN_MAX_RGT_by_YEAR_OLD]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                              CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.DRILLING_OPERATIONS_
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                                                           CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.DRILLING_OPERATIONS_ AS DRILLING_OPERATIONS_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Exploratory_Drilling_INDEX_MN_MAX_RGT_by_YEAR]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Exploratory_Drilling_INDEX_MN_MAX_RGT_by_YEAR]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                              CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN CATEGORY = '2nd Appraisal'
                                                                                               THEN 100 ELSE '0' END AS Unscaled_Score
                                                                       FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS
                                                                       WHERE      (Consession_Type = 'OML')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Category, Consession_Type, 
                                                                                                                           CASE WHEN CATEGORY = 'Exploration' THEN 100 WHEN CATEGORY = '1st Appraisal' THEN 100 WHEN CATEGORY = '2nd Appraisal'
                                                                                                                            THEN 100 ELSE '0' END AS Unscaled_Score
                                                                                                    FROM          dbo.DRILLING_OPERATIONS_CATEGORIES_OF_WELLS AS DRILLING_OPERATIONS_CATEGORIES_OF_WELLS_1
                                                                                                    WHERE      (Consession_Type = 'OML')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Facility_Project_Performance_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Facility_Project_Performance_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS int)) AS Utilized, SUM(CAST(Planned_completion AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.FACILITIES_PROJECT_PERFORMANCE
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Actual_completion AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(Planned_completion AS int)) AS Produced
                                                                                                    FROM          dbo.FACILITIES_PROJECT_PERFORMANCE AS FACILITIES_PROJECT_PERFORMANCE_1
                                                                                                  WHERE Consession_Type = 'OML'
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_FATALITY_Index_MN_MAX_RGT_by_Year_of_WP]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_FATALITY_Index_MN_MAX_RGT_by_Year_of_WP]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Consequence, Consession_Type, 
                                                                                                                           CASE WHEN Consequence = 'FATALITY' THEN 0 
                                                                                                                              --  ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                   -- WHERE      (Consession_Type = 'OML')
                                                                                                   ) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consequence, Consession_Type, 
                                                                                                                           CASE WHEN Consequence = 'FATALITY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                   -- WHERE      (Consession_Type = 'OML')
                                                                                                    ) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP
                                                                            , Consession_Type
                                                                            ) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_GAS_Utilisation_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_GAS_Utilisation_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS int)) AS Utilized, SUM(CAST(Current_Actual_Year AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.GAS_PRODUCTION_ACTIVITIES
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Utilized AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(Current_Actual_Year AS int)) AS Produced
                                                                                                    FROM          dbo.GAS_PRODUCTION_ACTIVITIES AS GAS_PRODUCTION_ACTIVITIES_1
                                                                                                    WHERE      (Consession_Type = 'OML')
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_INJURY_Index_MN_MAX_RGT_by_Year_of_WP_OLD]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Consequence, Consession_Type, 
                                                                                                                           CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                              --  ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                   -- WHERE      (Consession_Type = 'OML')
                                                                                                   ) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Consequence, Consession_Type, 
                                                                                                                           CASE WHEN Consequence = 'INJURY' THEN 0 
                                                                                                                               -- ELSE '100'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW AS HSE_ACCIDENT_INCIDENCE_REPORTING_TYPE_OF_ACCIDENT_NEW_1
                                                                                                   -- WHERE      (Consession_Type = 'OML')
                                                                                                    ) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP
                                                                            , Consession_Type
                                                                            ) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[WP_OML_RESERVE_REPLACEMENT_RATIO_STAGE_1_OLD]
AS
SELECT     CONVERT(VARCHAR(256), CompanyName) AS CompanyName, CONVERT(VARCHAR(256), Year_of_WP) AS Year_of_WP, CONVERT(VARCHAR(256), Consession_Type) 
                      AS Consession_Type, Reserves_as_at_MMbbl, Reserves_as_at_MMbbl_P1, Total_Production_, (CAST(Reserves_as_at_MMbbl AS int) 
                      - CAST(Reserves_as_at_MMbbl_P1 AS int)) /  ISNULL ( NULLIF ( CONVERT(decimal(18, 1), Total_Production_),0),1) * 100 AS Unscaled_Score
FROM         (SELECT     CompanyName, Year_of_WP, Consession_Type, SUM(CAST(Reserves_as_at_MMbbl AS int)) AS Reserves_as_at_MMbbl, 
                                              SUM(CAST(Reserves_as_at_MMbbl_P1 AS int)) AS Reserves_as_at_MMbbl_P1, SUM(CAST(Total_Production_ AS int)) AS Total_Production_
                       FROM          dbo.RESERVES_UPDATES_OIL_CONDENSATE_MMBBL AS RESERVES_UPDATES_OIL_CONDENSATE_MMBBL_1
                       WHERE      (Consession_Type = 'OML') -- and Total_Production_ != 0
                       GROUP BY CompanyName, Year_of_WP, Consession_Type) AS a

GO
/****** Object:  View [dbo].[WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, SUM(CAST(total_no_of_senior_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_senior_staff AS int)) AS Produced
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                 -- WHERE Consession_Type = 'OML'
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD2021]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Senior_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD2021]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, SUM(CAST(total_no_of_senior_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                            FROM          (
                                                                          

															 SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_nigeria_senior_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_senior_staff AS int)) AS Produced , Consession_Type
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                      WHERE      Consession_Type = 'OML'
                                                                                                                            GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                    
                                                                                                    ) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, SUM(CAST(total_no_of_top_management_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_top_management_staff AS int)) AS Produced
                                                                                                    FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                 -- WHERE Consession_Type = 'OML'
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD2021]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OML_Top_Management_Staff_INDEX_MN_MAX_RGT_by_YEAR_OLD2021]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Utilized, b.Produced, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), Produced) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, SUM(CAST(total_no_of_top_management_staff AS int)) 
                                                                                              AS Produced
                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Utilized, Produced, Utilized / CONVERT(decimal(18, 1), 
                                                                                                   Produced) * 100 AS Unscaled_Score
                                                                            FROM          (
                                                                            
                                                                                                                                                                             
                                                                                                      SELECT     CompanyName, Year_of_WP, SUM(CAST(total_no_of_top_nigerian_management_staff AS int)) AS Utilized, 
                                                                                                                           SUM(CAST(total_no_of_top_management_staff AS int)) AS Produced , Consession_Type
                                                                                                       FROM          dbo.NIGERIA_CONTENT_QUESTION AS NIGERIA_CONTENT_QUESTION_1
                                                                                                                         WHERE      Consession_Type = 'OML'
                                                                                                                         GROUP BY CompanyName, Year_of_WP , Consession_Type
                                                                                                                            
                                                                                                                            
                                                                                                    
                                                                                                    ) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_ACQUISITION_INDEX_MN_MAX_RGT_by_YEAR_OLD]
AS
SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     b.CompanyName, b.Year_of_WP, b.Quantum_Acquired, b.Quantum_Approved, b.Unscaled_Score, d.Unscaled_Score_sum, 
                                              b.Unscaled_Score / CONVERT(decimal(18, 1), d.Unscaled_Score_sum) * 100 AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), Quantum_Approved) 
                                                                      * 100 AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, SUM(CAST(Quantum_Approved AS int)) 
                                                                                              AS Quantum_Approved
                                                                       FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION
                                                                       GROUP BY CompanyName, Year_of_WP) AS a) AS b INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT     CompanyName, Year_of_WP, Quantum_Acquired, Quantum_Approved, Quantum_Acquired / CONVERT(decimal(18, 1), 
                                                                                                   Quantum_Approved) * 100 AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, SUM(CAST(Quantum AS int)) AS Quantum_Acquired, 
                                                                                                                           SUM(CAST(Quantum_Approved AS int)) AS Quantum_Approved
                                                                                                    FROM          dbo.GEOPHYSICAL_ACTIVITIES_ACQUISITION AS GEOPHYSICAL_ACTIVITIES_ACQUISITION_1
                                                                                                    WHERE      (Consession_Type = 'OPL')
                                                                                                    GROUP BY CompanyName, Year_of_WP) AS a_1) AS c
                                                    GROUP BY Year_of_WP) AS d ON b.Year_of_WP = d.Year_of_WP) AS f
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_COMPLIANCE_INDEX_CALCULATIONS]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_OPL_COMPLIANCE_INDEX_CALCULATIONS]
AS
SELECT     CompanyName, Consession_Type, Year_of_WP, SUM(Divisional_Sum) AS Total_Sum_All_Division
FROM         (SELECT     Id, CompanyName, Consession_Type, Year_of_WP, Divisions, Penalty_Factor_for_Warning, Number_of_Occurrence_of_Warnings, 
                                              Penalty_Factor_for_Sanction, Number_of_Occurrence_of_Sanctions, Penalty_Factor_for_Waivers, Number_of_Occurrence_of_Waivers, 
                                              Compliance_index_for_each_division, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Warning) / 100, Number_of_Occurrence_of_Warnings) 
                                              AS Penalty_Factor_for_Warning_Calculation, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Sanction) / 100, 
                                              Number_of_Occurrence_of_Sanctions) AS Penalty_Factor_for_Sanction_Calculation, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Waivers) 
                                              / 100, Number_of_Occurrence_of_Waivers) AS Penalty_Factor_for_Waivers_Calculation, POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Warning)
                                               / 100, Number_of_Occurrence_of_Warnings) + POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Sanction) / 100, 
                                              Number_of_Occurrence_of_Sanctions) + POWER(1 - CONVERT(decimal(18, 3), Penalty_Factor_for_Waivers) / 100, Number_of_Occurrence_of_Waivers) 
                                              AS Divisional_Sum, Created_by, Updated_by, Date_Created, Date_Updated
                       FROM          dbo.ADMIN_COMPLIANCE_INDEX_TABLE
                       WHERE      (Consession_Type = 'OPL')) AS a
GROUP BY CompanyName, Consession_Type, Year_of_WP
GO
/****** Object:  View [dbo].[WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR_OLD]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_OPL_Discovery_Index_MN_MAX_RGT_by_YEAR_OLD]
AS


SELECT     Year_of_WP, MAX(Scaled_by_Reciprocal_GrandTotal_RGT) AS MAX_RGT, MIN(Scaled_by_Reciprocal_GrandTotal_RGT) AS MIN_RGT
FROM         (SELECT     D.CompanyName, D.Year_of_WP, D.Consession_Type, D.Unscaled_Score, E.Unscaled_Score_sum, 
                                              ISNULL(D.Unscaled_Score / NULLIF (CONVERT(decimal(18, 1), E.Unscaled_Score_sum), 0) * 100, 0) AS Scaled_by_Reciprocal_GrandTotal_RGT
                       FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                               FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                              CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                       FROM          dbo.DRILLING_OPERATIONS_
                                                                       WHERE      (Consession_Type = 'OPL')) AS A
                                               GROUP BY CompanyName, Year_of_WP, Consession_Type) AS D INNER JOIN
                                                  (SELECT     Year_of_WP, SUM(Unscaled_Score) AS Unscaled_Score_sum
                                                    FROM          (SELECT DISTINCT CompanyName, Year_of_WP, Consession_Type, MAX(Unscaled_Score) AS Unscaled_Score
                                                                            FROM          (SELECT     CompanyName, Year_of_WP, Any_New_Discoveries, Consession_Type, 
                                                                                                                           CASE WHEN Any_New_Discoveries = 'YES' THEN 100 
                                                                                                                                ELSE '0'
                                                                                                                              END AS Unscaled_Score
                                                                                                                              
                                                                                                    FROM          dbo.DRILLING_OPERATIONS_ AS DRILLING_OPERATIONS_1
                                                                                                    WHERE      (Consession_Type = 'OPL')) AS A_1
                                                                            GROUP BY CompanyName, Year_of_WP, Consession_Type) AS c
                                                    GROUP BY Year_of_WP) AS E ON D.Year_of_WP = E.Year_of_WP) AS F
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

/****** Script for SelectTopNRows command from SSMS  ******/
CREATE VIEW [dbo].[WP_RESERVES_UPDATES_OIL_CONDENSATE_MMBBL]
AS
SELECT     Year_of_WP, SUM(CAST(Reserves_as_at_MMbbl AS decimal)) AS Reserves_as_at_MMbbl, SUM(CAST(Reserves_as_at_MMbbl_gas AS decimal)) 
                      AS Reserves_as_at_MMbbl_gas, SUM(CAST(Reserves_as_at_MMbbl_condensate AS decimal)) AS Reserves_as_at_MMbbl_condensate
FROM         dbo.RESERVES_UPDATES_OIL_CONDENSATE_MMBBL
GROUP BY Year_of_WP
GO
/****** Object:  View [dbo].[WP_RESERVES_UPDATES_OIL_CONDENSATE_STATUS_OF_RESERVE_CURRENT]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_RESERVES_UPDATES_OIL_CONDENSATE_STATUS_OF_RESERVE_CURRENT]
AS
SELECT     Total_Company_Reserves_Oil, Total_Company_Reserves_Condensate, 
                      Total_Company_Reserves_Oil + Total_Company_Reserves_Condensate AS Total_oil_plus_condensate, Total_Company_Reserves_AG, 
                      Total_Company_Reserves_NAG, Total_Company_Reserves_AG + Total_Company_Reserves_NAG AS Total_AG_NAG, FLAG1, Company_Reserves_Year
FROM         (SELECT     Company_Reserves_Year, SUM(CONVERT(decimal(18, 3), Company_Reserves_Oil)) AS Total_Company_Reserves_Oil, SUM(CONVERT(decimal(18, 3), 
                                              Company_Reserves_Condensate)) AS Total_Company_Reserves_Condensate, SUM(CONVERT(decimal(18, 3), Company_Reserves_AG)) 
                                              AS Total_Company_Reserves_AG, SUM(CONVERT(decimal(18, 3), Company_Reserves_NAG)) AS Total_Company_Reserves_NAG, FLAG1
                       FROM          dbo.RESERVES_UPDATES_OIL_CONDENSATE_STATUS_OF_RESERVE
                       WHERE      (FLAG1 = 'COMPANY_CURRENT_RESERVE')
                       GROUP BY Company_Reserves_Year, FLAG1) AS A
GO
/****** Object:  View [dbo].[WP_RESERVES_UPDATES_OIL_CONDENSATE_STATUS_OF_RESERVE_CURRENT_PLANNED]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_RESERVES_UPDATES_OIL_CONDENSATE_STATUS_OF_RESERVE_CURRENT_PLANNED]
AS


SELECT     Total_Company_Reserves_Oil, Total_Company_Reserves_Condensate, 
                      Total_Company_Reserves_Oil + Total_Company_Reserves_Condensate AS Total_oil_plus_condensate, Total_Company_Reserves_AG, 
                      Total_Company_Reserves_NAG, Total_Company_Reserves_AG + Total_Company_Reserves_NAG AS Total_AG_NAG,  Fiveyear_Projection_Year
FROM         (SELECT     Fiveyear_Projection_Year, SUM(CONVERT(decimal(18, 3), Fiveyear_Projection_Oil)) AS Total_Company_Reserves_Oil, SUM(CONVERT(decimal(18, 3), 
                                              Fiveyear_Projection_Condensate)) AS Total_Company_Reserves_Condensate, SUM(CONVERT(decimal(18, 3), Fiveyear_Projection_AG)) 
                                              AS Total_Company_Reserves_AG, SUM(CONVERT(decimal(18, 3), Fiveyear_Projection_NAG)) AS Total_Company_Reserves_NAG
                       FROM          dbo.RESERVES_UPDATES_OIL_CONDENSATE_Fiveyear_Projection
                      
                       GROUP BY Fiveyear_Projection_Year) AS A
GO
/****** Object:  View [dbo].[WP_Total_E_and_P_companies]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_Total_E_and_P_companies]
AS
SELECT     COUNT(DISTINCT CompanyName) AS E_and_P_companies, Year
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION
GROUP BY Year
GO
/****** Object:  View [dbo].[WP_Total_E_and_P_companies_old]    Script Date: 10/20/2022 11:27:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[WP_Total_E_and_P_companies_old]
AS
SELECT     COUNT(Year) AS E_and_P_companies, Year
FROM         dbo.ADMIN_CONCESSIONS_INFORMATION
GROUP BY Year
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "ADMIN_COMPANY_INFORMATION"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 136
               Right = 275
            End
            DisplayFlags = 280
            TopColumn = 11
         End
         Begin Table = "ADMIN_CONCESSIONS_INFORMATION"
            Begin Extent = 
               Top = 6
               Left = 313
               Bottom = 136
               Right = 522
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'ADMIN_COMPANYEMAIL_REMINDER_TABLE'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'ADMIN_COMPANYEMAIL_REMINDER_TABLE'
GO
